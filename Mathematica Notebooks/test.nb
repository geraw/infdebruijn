(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     70894,       1660]
NotebookOptionsPosition[     70034,       1632]
NotebookOutlinePosition[     70406,       1648]
CellTagsIndexPosition[     70363,       1645]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", "[", "w_", "]"}], ":=", " ", 
  RowBox[{"w", "/.", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d_", ",", "x___"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d", "+", "1"}], ",", "x"}], "}"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "[", 
   RowBox[{"w_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"PadLeft", "[", 
   RowBox[{"w", ",", "n"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f3", "[", "w_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"w", " ", "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Longest", "[", "uu__", "]"}], ",", "vv__", ",", "uu__"}], 
        "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"vv", ",", "uu"}], "}"}]}]}], ")"}], " ", "/.", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"uu__", ".."}], "}"}], "\[Rule]", 
     RowBox[{"{", "uu", "}"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"w_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"f3", "[", 
   RowBox[{"f2", "[", 
    RowBox[{
     RowBox[{"f1", "[", "w", "]"}], ",", "n"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ff", "[", 
    RowBox[{"w_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"NestWhile", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"#", ",", "n"}], "]"}], "&"}], ",", 
     RowBox[{"f", "[", 
      RowBox[{"w", ",", "n"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Not", "[", 
       RowBox[{"Divisible", "[", 
        RowBox[{"n", ",", 
         RowBox[{"Length", "[", "#", "]"}]}], "]"}], "]"}], "&"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", "[", 
   RowBox[{"w_", ",", "n_"}], "]"}], ":=", " ", 
  RowBox[{"Take", "[", 
   RowBox[{
    RowBox[{"Join", " ", "@@", " ", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{"w", "&"}], ",", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"n", "/", 
         RowBox[{"Length", "[", "w", "]"}]}], "]"}]}], "]"}]}], ",", 
    RowBox[{"-", "n"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", "[", "w_", "]"}], ":=", " ", 
  RowBox[{"w", "/.", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Longest", "[", 
       RowBox[{
        RowBox[{"(", "0", ")"}], ".."}], "]"}], ",", "x__"}], "}"}], 
    "\[Rule]", 
    RowBox[{"{", "x", "}"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b3", "[", "w_", "]"}], ":=", " ", 
   RowBox[{"w", "/.", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d_", ",", "x___"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"d", "-", "1"}], ",", "x"}], "}"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "[", 
   RowBox[{"w_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"b3", "[", 
   RowBox[{"b2", "[", 
    RowBox[{"b1", "[", 
     RowBox[{"w", ",", "n"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bb", "[", 
    RowBox[{"w_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"NestWhile", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"b", "[", 
       RowBox[{"#", ",", "n"}], "]"}], "&"}], ",", 
     RowBox[{"b", "[", 
      RowBox[{"w", ",", "n"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Not", "[", 
       RowBox[{"Divisible", "[", 
        RowBox[{"n", ",", 
         RowBox[{"Length", "[", "#", "]"}]}], "]"}], "]"}], "&"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k", "=", "4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lst", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"lst", "[", "n", "]"}], "=", 
   RowBox[{"NestWhileList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ff", "[", 
       RowBox[{"#", ",", "n"}], "]"}], "&"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{
      RowBox[{"#", "\[NotEqual]", 
       RowBox[{"{", 
        RowBox[{"k", "-", "1"}], "}"}]}], "&"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"seq", "[", "n_", "]"}], ":=", 
    RowBox[{
     RowBox[{"seq", "[", "n", "]"}], "=", " ", 
     RowBox[{"Join", "@@", 
      RowBox[{"lst", "[", "n", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bseq", "[", "n_", "]"}], " ", ":=", 
   RowBox[{"Join", " ", "@@", " ", 
    RowBox[{"Reverse", "[", 
     RowBox[{"NestWhileList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"bb", "[", 
         RowBox[{"#", ",", "n"}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", "-", "1"}], "}"}], ",", 
       RowBox[{
        RowBox[{"#", "\[NotEqual]", 
         RowBox[{"{", "0", "}"}]}], "&"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bseq", "[", "n", "]"}], "==", 
  RowBox[{"seq", "[", "n", "]"}]}]}], "Input",
 CellChangeTimes->{
  3.6812343385950136`*^9, {3.6812343738408*^9, 3.6812344062205524`*^9}, {
   3.681234472208804*^9, 3.681234486030609*^9}, 3.681234591933275*^9, {
   3.6812350099369373`*^9, 3.6812350408702183`*^9}, {3.681235318278736*^9, 
   3.6812353200346546`*^9}, {3.681235895799814*^9, 3.681235896697755*^9}, {
   3.6812359272082043`*^9, 3.681235934879717*^9}, {3.6812368799348383`*^9, 
   3.6812368961979017`*^9}, {3.681236937736692*^9, 3.6812369412067266`*^9}, {
   3.6812394318586287`*^9, 3.6812394386338162`*^9}, {3.6812402321830063`*^9, 
   3.6812402350981364`*^9}, {3.681284857122822*^9, 3.6812848609786463`*^9}, {
   3.6812900845324564`*^9, 3.6812901289896297`*^9}, {3.681319972735944*^9, 
   3.6813199737963333`*^9}, {3.68140201638933*^9, 3.681402095029662*^9}, {
   3.6814023951337824`*^9, 3.681402420929696*^9}, {3.6814025639707747`*^9, 
   3.6814025676765027`*^9}, 3.6814029191413994`*^9, {3.681403401842312*^9, 
   3.6814034328818254`*^9}, {3.6814037201096683`*^9, 3.681403806476817*^9}, {
   3.681404803275767*^9, 3.6814048711381655`*^9}, 3.6816115597326756`*^9, {
   3.6819568823792295`*^9, 3.6819568963946657`*^9}, 3.681982992267831*^9, {
   3.681983030907017*^9, 3.681983094302966*^9}, {3.681983279050273*^9, 
   3.681983304437924*^9}, {3.682220615186222*^9, 3.6822206580684304`*^9}, {
   3.6822464761656*^9, 3.682246488867901*^9}, {3.683343298682266*^9, 
   3.683343334773266*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dev", "[", "n_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"dev", "[", "n", "]"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"s", "=", "0"}], ";", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"s", "+=", 
           RowBox[{"Length", "[", "#", "]"}]}], ")"}], "&"}], " ", "/@", " ", 
        RowBox[{"lst", "[", "n", "]"}]}]}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rotations", "[", "w_", "]"}], ":=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"NestList", "[", 
     RowBox[{"RotateLeft", ",", "w", ",", 
      RowBox[{
       RowBox[{"Length", "[", "w", "]"}], "-", "1"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"val", "[", "w_", "]"}], ":=", 
  RowBox[{"ToString", "[", 
   RowBox[{"Reverse", "[", "w", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toLyndon", "[", "w_", "]"}], ":=", 
   RowBox[{
    RowBox[{"MaximalBy", "[", 
     RowBox[{
      RowBox[{"rotations", "[", "w", "]"}], ",", "val"}], "]"}], 
    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isLyndon", "[", "w_", "]"}], ":=", 
  RowBox[{
   RowBox[{"toLyndon", "[", "w", "]"}], "\[Equal]", 
   "w"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lyndonIndex", "[", "w_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{
       RowBox[{"rotations", "[", 
        RowBox[{"toLyndon", "[", "w", "]"}], "]"}], ",", "w"}], "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "-", "1"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"canIncrease", "[", "w_", "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"l", "=", 
        RowBox[{"toLyndon", "[", "w", "]"}]}], ",", 
       RowBox[{"i", "=", 
        RowBox[{"lyndonIndex", "[", "w", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"i", "+", "1"}], "\[Equal]", "n"}], "\[Or]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"l", "\[LeftDoubleBracket]", 
          RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "\[NotEqual]", 
         RowBox[{"Max", "[", "w", "]"}]}], "\[And]", 
        RowBox[{"isLyndon", "[", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"l", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "+", "1"}], ")"}], "\[Rule]", 
            RowBox[{
             RowBox[{"l", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "+", 
             "1"}]}]}], " ", "]"}], "]"}]}], ")"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"canIncrease", "[", "w_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ww", "=", 
      RowBox[{"toLyndon", "[", "w", "]"}]}], ";", 
     RowBox[{"i", "=", 
      RowBox[{"lyndonIndex", "[", "w", "]"}]}], ";", 
     RowBox[{"www", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"ww", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "+", "1"}], ")"}], "\[Rule]", 
         RowBox[{
          RowBox[{"ww", "\[LeftDoubleBracket]", 
           RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "+", "1"}]}]}],
        " ", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"i", "+", "1"}], "\[Equal]", "n"}], "\[Or]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ww", "\[LeftDoubleBracket]", 
          RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "\[NotEqual]", 
         RowBox[{"Max", "[", "w", "]"}]}], "\[And]", 
        RowBox[{"isLyndon", "[", "www", "]"}]}], ")"}]}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"canIncrease", "[", "w_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ww", "=", 
      RowBox[{"toLyndon", "[", "w", "]"}]}], ";", 
     RowBox[{"i", "=", 
      RowBox[{"lyndonIndex", "[", "w", "]"}]}], ";", 
     RowBox[{"www", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"ww", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "+", "1"}], ")"}], "\[Rule]", 
         RowBox[{
          RowBox[{"ww", "\[LeftDoubleBracket]", 
           RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "+", "1"}]}]}],
        " ", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"Most", "[", "www", "]"}], "]"}], "\[LessEqual]", " ", 
       RowBox[{"Max", "[", "w", "]"}]}], "\[And]", 
      RowBox[{"isLyndon", "[", "www", "]"}]}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trailingZ", "[", "w_", "]"}], ":=", 
  RowBox[{"And", " ", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"#", "\[Equal]", "0"}], ")"}], "&"}], "  ", "/@", 
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"toLyndon", "[", "w", "]"}], ",", 
       RowBox[{"lyndonIndex", "[", "w", "]"}]}], "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.681103547464664*^9, 3.6811036836729593`*^9}, {
   3.681103767456843*^9, 3.681103786858462*^9}, {3.6811040348428736`*^9, 
   3.681104071048169*^9}, {3.681104189812095*^9, 3.681104195290648*^9}, {
   3.681104509834357*^9, 3.681104552397544*^9}, {3.6811085609323435`*^9, 
   3.681108564436673*^9}, {3.6811086132915974`*^9, 3.6811086141900206`*^9}, {
   3.681124493898198*^9, 3.6811244943965235`*^9}, 3.6811262999822145`*^9, {
   3.68112650790829*^9, 3.6811265634219604`*^9}, {3.681126593938162*^9, 
   3.681126610671637*^9}, {3.681144184461918*^9, 3.681144186368018*^9}, 
   3.6811442536399527`*^9, {3.6811771534066963`*^9, 3.681177154642088*^9}, {
   3.681178007154801*^9, 3.681178017987858*^9}, {3.681178924720995*^9, 
   3.681178959180601*^9}, {3.681179328095487*^9, 3.6811793286505446`*^9}, {
   3.681179737943857*^9, 3.681179766686838*^9}, {3.6812339578399973`*^9, 
   3.681233958464327*^9}, {3.6812341064550867`*^9, 3.6812341202875643`*^9}, {
   3.6812341547639294`*^9, 3.681234192094988*^9}, {3.681234324346789*^9, 
   3.6812343246787634`*^9}, {3.6812351122410126`*^9, 
   3.6812351128402567`*^9}, {3.6812351666190577`*^9, 
   3.6812351674250565`*^9}, {3.681235257865267*^9, 3.6812353086679316`*^9}, {
   3.6812353478749056`*^9, 3.6812353626443977`*^9}, {3.6812354229909515`*^9, 
   3.68123547840138*^9}, {3.681404890667019*^9, 3.681404890808956*^9}, {
   3.6814049260596523`*^9, 3.681404936753445*^9}, {3.681572771580958*^9, 
   3.6815727989585238`*^9}, 3.6815729100952387`*^9, {3.681611797682182*^9, 
   3.6816118039692907`*^9}, {3.682221981529203*^9, 3.682221981872974*^9}, {
   3.6823567927065315`*^9, 3.682356834773063*^9}, {3.6823568894872184`*^9, 
   3.6823569097719917`*^9}, {3.6823569411690855`*^9, 
   3.6823570206953845`*^9}, {3.682390291628702*^9, 3.6823902982814274`*^9}, {
   3.6823927673284254`*^9, 3.682392813582635*^9}, {3.6823929395719724`*^9, 
   3.682392975596858*^9}, {3.6823930270151463`*^9, 3.6823931573118544`*^9}, {
   3.682393208023761*^9, 3.6823933730320444`*^9}, {3.682393420877141*^9, 
   3.6823934510166883`*^9}, {3.6823935788625574`*^9, 3.682393579526467*^9}, {
   3.682393855656685*^9, 3.6823938736681347`*^9}, {3.6823940175376945`*^9, 
   3.682394154781617*^9}, 3.682394194930356*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "nxt", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nxt", "[", "w_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ff", "[", 
      RowBox[{
       RowBox[{"f3", "[", "w", "]"}], ",", "n"}], "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ")"}], " ", "/;",
    " ", 
   RowBox[{"isLyndon", "[", "w", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nxt", "[", "w_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"w", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
    "1"}], " ", "/;", " ", 
   RowBox[{
    RowBox[{"trailingZ", "[", "w", "]"}], " ", "\[And]", 
    RowBox[{"canIncrease", "[", "w", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nxt", "[", "w_", "]"}], ":=", 
  RowBox[{"0", "/;", " ", 
   RowBox[{
    RowBox[{"trailingZ", "[", "w", "]"}], " ", "\[And]", 
    RowBox[{"Not", "[", 
     RowBox[{"canIncrease", "[", "w", "]"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nxt", "[", "w_", "]"}], ":=", 
   RowBox[{"w", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myseq", "=", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "n"}], "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"AppendTo", " ", "[", 
     RowBox[{"myseq", ",", " ", 
      RowBox[{"nxt", "[", 
       RowBox[{"Take", "[", 
        RowBox[{"myseq", ",", 
         RowBox[{"-", "n"}]}], "]"}], "]"}]}], "]"}], " ", ",", 
    RowBox[{
     SuperscriptBox["k", "n"], "-", "n", "-", "1"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"myseq", "==", 
  RowBox[{"seq", "[", "n", "]"}]}]}], "Input",
 CellChangeTimes->{{3.681124209600976*^9, 3.681124268397375*^9}, {
   3.681124326060757*^9, 3.681124348452318*^9}, {3.6811243868173666`*^9, 
   3.681124438496834*^9}, {3.6811245483751063`*^9, 3.681124553629081*^9}, {
   3.6811246189067173`*^9, 3.6811246334032784`*^9}, {3.681125297454528*^9, 
   3.681125463947387*^9}, {3.6811255580236316`*^9, 3.6811256016837673`*^9}, {
   3.681125645221571*^9, 3.6811256685877576`*^9}, {3.6811257276317787`*^9, 
   3.681125759954762*^9}, {3.6811258128895626`*^9, 3.6811258521850863`*^9}, {
   3.6811259105222607`*^9, 3.6811259151906843`*^9}, {3.6811260119380293`*^9, 
   3.681126015785262*^9}, {3.6811260762099886`*^9, 3.681126165698027*^9}, {
   3.6811266491038723`*^9, 3.681126734504032*^9}, {3.68112681709973*^9, 
   3.681126900026315*^9}, 3.681126939166427*^9, {3.68112730792333*^9, 
   3.681127489916432*^9}, {3.6811275283626666`*^9, 3.6811275504454374`*^9}, {
   3.6811275946199107`*^9, 3.681127603319048*^9}, {3.6811439907817297`*^9, 
   3.6811440008605804`*^9}, {3.6811758687572837`*^9, 3.681175895399081*^9}, {
   3.681175959885781*^9, 3.6811759687488174`*^9}, {3.6811760068465786`*^9, 
   3.6811760070688696`*^9}, {3.681176146958003*^9, 3.681176163137535*^9}, {
   3.681176233408076*^9, 3.6811762351032553`*^9}, {3.6811771632671595`*^9, 
   3.681177200898227*^9}, {3.6811772403922567`*^9, 3.6811772506736617`*^9}, {
   3.681177324364559*^9, 3.6811773423674145`*^9}, {3.6811774023173337`*^9, 
   3.681177402714535*^9}, {3.681177679615759*^9, 3.681177681413635*^9}, {
   3.6811777704815755`*^9, 3.6811777944864006`*^9}, {3.6811778325715456`*^9, 
   3.6811778549413524`*^9}, {3.6811778920336895`*^9, 
   3.6811780514007444`*^9}, {3.681178092113549*^9, 3.681178227526745*^9}, {
   3.681179366022626*^9, 3.681179396467493*^9}, {3.6811794543258667`*^9, 
   3.681179479608823*^9}, {3.681179786327493*^9, 3.681179804377884*^9}, {
   3.6812336644935875`*^9, 3.6812338253164883`*^9}, {3.68123386389913*^9, 
   3.681233880247927*^9}, {3.6812339142429748`*^9, 3.6812339147035913`*^9}, {
   3.6812340008027644`*^9, 3.681234007035535*^9}, {3.6812344390660954`*^9, 
   3.6812344597193737`*^9}, {3.6812345104639125`*^9, 
   3.6812345655827484`*^9}, {3.681235827328601*^9, 3.681235882717334*^9}, {
   3.681403467260279*^9, 3.6814035064429913`*^9}, {3.6815728614752245`*^9, 
   3.6815728622464004`*^9}, {3.6815729203858833`*^9, 3.681572921913185*^9}, {
   3.6822220003690753`*^9, 3.6822220010127306`*^9}, {3.6823557141057005`*^9, 
   3.68235575641883*^9}, {3.6823934640683956`*^9, 3.6823934744084206`*^9}, {
   3.6823935103235292`*^9, 3.682393558168972*^9}, {3.6823936399848547`*^9, 
   3.682393734308934*^9}, {3.682393788633649*^9, 3.682393831394211*^9}, 
   3.6833433163274918`*^9, {3.684750791044098*^9, 3.6847507912682385`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"form", "=", 
    RowBox[{"FormPage", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<n\>\"", "\[Rule]", "\"\<Integer\>\""}], ",", 
        RowBox[{"\"\<word\>\"", "\[Rule]", 
         RowBox[{"Restricted", "[", 
          RowBox[{"\"\<String\>\"", ",", 
           RowBox[{"RegularExpression", "[", "\"\<[0-9]+\>\"", "]"}]}], 
          "]"}]}], ",", 
        RowBox[{"\"\<Direction\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Forward\>\"", ",", "\"\<Backward\>\""}], "}"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"w", "=", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"Characters", "[", "#word", "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#Direction", "\[Equal]", "\"\<Forward\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Grid", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<1) Increase the left digit     :\>\"", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<.....\>\"", ",", "White"}], "]"}], " ", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"Row", "[", 
                   RowBox[{"f1", "[", "w", "]"}], "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<2) Pad with zeroes on the left\\t :\>\"", ",", " ", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"Row", "[", 
                   RowBox[{"f2", "[", 
                    RowBox[{
                    RowBox[{"f1", "[", "w", "]"}], ",", "#n"}], "]"}], "]"}], 
                  "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<3) Apply x(yx)*\[RightArrow]yx :\>\"", ",", ",", "  ", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"Row", "[", 
                   RowBox[{"f3", "[", 
                    RowBox[{"f2", "[", 
                    RowBox[{
                    RowBox[{"f1", "[", "w", "]"}], ",", "#n"}], "]"}], "]"}], 
                   "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
             RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], " ", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Grid", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<1) Extend to lenght n leftwards by repetition    :\>\"", 
                 ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<.....\>\"", ",", "White"}], "]"}], " ", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"Row", "[", 
                   RowBox[{"b1", "[", 
                    RowBox[{"w", ",", "#n"}], "]"}], "]"}], "]"}]}], "}"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\"\<2) Remove leading zeros :\>\"", ",", " ", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"Row", "[", 
                   RowBox[{"b2", "[", 
                    RowBox[{"b1", "[", 
                    RowBox[{"w", ",", "#n"}], "]"}], "]"}], "]"}], "]"}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<3) Decrease the left digit :\>\"", ",", ",", "  ", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"Row", "[", 
                   RowBox[{"b3", "[", 
                    RowBox[{"b2", "[", 
                    RowBox[{"b1", "[", 
                    RowBox[{"w", ",", "#n"}], "]"}], "]"}], "]"}], "]"}], 
                  "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
             RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "]"}], "&"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"CloudDeploy", "[", 
  RowBox[{
   RowBox[{"form", "[", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<n\>\"", "\[Rule]", "4"}], ",", 
      RowBox[{"\"\<word\>\"", "\[Rule]", "\"\<0101\>\""}]}], "|>"}], "]"}], 
   ",", "\"\<Next word generator\>\"", ",", 
   RowBox[{"Permissions", "\[Rule]", "\"\<Public\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6813171567854805`*^9, 3.681317164802116*^9}, {
   3.6813172828386784`*^9, 3.68131730089837*^9}, {3.6813188648247366`*^9, 
   3.681318870912368*^9}, {3.6813190428843374`*^9, 3.681319180856572*^9}, {
   3.6813195952449036`*^9, 3.6813196096997375`*^9}, {3.6813197624666543`*^9, 
   3.6813197760106177`*^9}, {3.6813198356609807`*^9, 
   3.6813199037256193`*^9}, {3.681319936576933*^9, 3.681319939268124*^9}, {
   3.6813222966042113`*^9, 3.6813223188453026`*^9}, {3.6813223510106735`*^9, 
   3.6813226457300844`*^9}, {3.6813226969678035`*^9, 
   3.6813227054204445`*^9}, {3.6813227390229177`*^9, 
   3.6813227748425736`*^9}, {3.6813228081050653`*^9, 
   3.6813228441626453`*^9}, {3.681323116057881*^9, 3.6813231243076262`*^9}, 
   3.681323164021723*^9, {3.681323250868307*^9, 3.6813233231286497`*^9}, 
   3.681323378420868*^9, 3.681323412316559*^9, {3.681323494518881*^9, 
   3.681323543442251*^9}, 3.681323620817113*^9, 3.681323694235553*^9, 
   3.681323739311928*^9, {3.681323769491352*^9, 3.681323994475787*^9}, 
   3.681324029219691*^9, {3.6813240596131096`*^9, 3.681324062201486*^9}, {
   3.6813241021041317`*^9, 3.681324110646672*^9}, {3.6813241438213463`*^9, 
   3.6813241701299925`*^9}, {3.681324251655831*^9, 3.6813242775755725`*^9}, {
   3.681324328876108*^9, 3.6813243462436047`*^9}, {3.681324425549033*^9, 
   3.681324428349084*^9}, 3.6813245050931115`*^9, {3.681324549092112*^9, 
   3.6813246985185432`*^9}, 3.681324729919908*^9, {3.6813247740972223`*^9, 
   3.681324778665601*^9}, {3.681324829015518*^9, 3.6813249054256926`*^9}, {
   3.68132495029368*^9, 3.6813249510383444`*^9}, {3.681324981345358*^9, 
   3.6813249899285946`*^9}, {3.681325497986582*^9, 3.681325533376735*^9}, {
   3.6813255640085773`*^9, 3.681325600360705*^9}, {3.681325649246523*^9, 
   3.6813256711439295`*^9}, {3.681325702563489*^9, 3.6813257544505296`*^9}, {
   3.681325807587268*^9, 3.681325866726122*^9}, {3.6813259204585466`*^9, 
   3.681325981130905*^9}, {3.6813260697915764`*^9, 3.681326090602209*^9}, {
   3.681326240580687*^9, 3.6813262968073273`*^9}, {3.681326330541162*^9, 
   3.6813268102856193`*^9}, {3.681326994434182*^9, 3.6813270361942186`*^9}, {
   3.68132708714425*^9, 3.6813270924505367`*^9}, {3.6813271498261046`*^9, 
   3.6813274754832773`*^9}, {3.681327507111298*^9, 3.681327611008257*^9}, 
   3.681400713705187*^9, {3.6814010386583705`*^9, 3.681401050404652*^9}, {
   3.681401137166792*^9, 3.6814011376728516`*^9}, {3.6814011730566945`*^9, 
   3.681401173771812*^9}, {3.6814014964428234`*^9, 3.6814016171155663`*^9}, {
   3.6814017734017553`*^9, 3.681401840759055*^9}, {3.681402183168148*^9, 
   3.681402188612306*^9}, {3.681625852086527*^9, 3.681625861972988*^9}, {
   3.6816259090917816`*^9, 3.6816259391564302`*^9}, {3.6816259953471518`*^9, 
   3.681625999313744*^9}, {3.6816260595711236`*^9, 3.681626371497976*^9}, {
   3.681626446504995*^9, 3.6816264477207894`*^9}, {3.6816264814968634`*^9, 
   3.6816265459910116`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"w", "=", 
    RowBox[{"RotateRight", "[", 
     RowBox[{"w", ",", "3"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rep", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "\[Rule]", 
       RowBox[{"Highlighted", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"seq", "[", "n", "]"}], "\[LeftDoubleBracket]", "#", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"FrameMargins", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], "]"}]}], ")"}], 
     "&"}], " ", "/@", " ", 
    RowBox[{"(", 
     RowBox[{"Range", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"SequencePosition", "[", 
         RowBox[{
          RowBox[{"seq", "[", "n", "]"}], ",", "w"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ")"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fseq", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"seq", "[", "n", "]"}], ",", "rep"}], " ", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Row", " ", "@", " ", 
  RowBox[{"Insert", "[", 
   RowBox[{"fseq", ",", "\"\<|\>\"", ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", "#", "}"}], "&"}], " ", "/@", " ", 
      RowBox[{"Most", "[", 
       RowBox[{"dev", "[", "n", "]"}], "]"}]}], "+", "1"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6814029257971225`*^9, 3.681402960631489*^9}, {
   3.681403048189619*^9, 3.6814030510603266`*^9}, {3.681403326026517*^9, 
   3.681403387323757*^9}, {3.6814035861542716`*^9, 3.6814036014894295`*^9}, {
   3.6814036326299515`*^9, 3.681403692955456*^9}, {3.681403835051219*^9, 
   3.681404137954033*^9}, {3.681404176726445*^9, 3.6814041779544764`*^9}, 
   3.6814042639815693`*^9, {3.681404319180153*^9, 3.6814043255385633`*^9}, {
   3.6814043799187784`*^9, 3.6814046325271287`*^9}, {3.681404717466545*^9, 
   3.6814047466981316`*^9}, {3.6814051470457644`*^9, 3.681405185042739*^9}, {
   3.681405265329268*^9, 3.6814052754150543`*^9}, {3.681405330392881*^9, 
   3.6814053666831627`*^9}, 3.681405401889221*^9, {3.6814054689741287`*^9, 
   3.681405493597322*^9}, {3.681405536686168*^9, 3.6814056103132534`*^9}, {
   3.6814056459145327`*^9, 3.6814057075719247`*^9}, {3.6814057417422905`*^9, 
   3.681405791583989*^9}, {3.681405831713357*^9, 3.6814058341356072`*^9}, {
   3.6814058646837015`*^9, 3.6814058671626225`*^9}, {3.6815720834856663`*^9, 
   3.681572093488958*^9}, {3.6815726991697607`*^9, 3.6815727001555915`*^9}, {
   3.681574090038418*^9, 3.681574117873005*^9}, {3.681575209093699*^9, 
   3.6815752288765726`*^9}, {3.681611673605094*^9, 3.6816116741474485`*^9}, {
   3.6816117517141404`*^9, 3.6816117533131876`*^9}, {3.681611812656968*^9, 
   3.6816118128320827`*^9}, {3.6816283520963497`*^9, 
   3.6816283555526066`*^9}, {3.6816430847286725`*^9, 
   3.6816431292864323`*^9}, {3.6817084842752295`*^9, 
   3.6817085982046547`*^9}, {3.681710296090865*^9, 3.681710298253182*^9}, {
   3.68171080337695*^9, 3.6817108061905465`*^9}, 3.6817108668387766`*^9, {
   3.681713710024721*^9, 3.6817137101341057`*^9}, {3.6817138448141665`*^9, 
   3.681713845470437*^9}, {3.6817149154854727`*^9, 3.6817149433734765`*^9}, {
   3.6817288689147973`*^9, 3.6817289063579416`*^9}, {3.6819681623815084`*^9, 
   3.6819682388096266`*^9}, {3.681985232139865*^9, 3.6819852517853827`*^9}, 
   3.6819853360779557`*^9, 3.6819857083936653`*^9, 3.682058051971602*^9, 
   3.682058111506566*^9, {3.68205814584326*^9, 3.6820581521404786`*^9}, 
   3.682066182490555*^9, {3.6820667516625233`*^9, 3.6820667531985273`*^9}, 
   3.682067229813007*^9, 3.6820682561587505`*^9, {3.6820691932611704`*^9, 
   3.6820692168115606`*^9}, {3.6820693814631653`*^9, 3.682069385702936*^9}, 
   3.682069733232055*^9, 3.682069767247285*^9, {3.6820703940449133`*^9, 
   3.682070396195318*^9}, {3.6820705093762856`*^9, 3.682070535759527*^9}, {
   3.682130730057235*^9, 3.6821307639443808`*^9}, 3.6821308307430353`*^9, {
   3.682131149057061*^9, 3.6821311492802076`*^9}, {3.682131196416012*^9, 
   3.682131214831047*^9}, {3.682131489673663*^9, 3.682131515080268*^9}, {
   3.6821318138745365`*^9, 3.6821318166113253`*^9}, 3.6821318538736773`*^9, {
   3.6821333013796597`*^9, 3.682133315891144*^9}, 3.6821333517135553`*^9, {
   3.6821334012649374`*^9, 3.682133405728855*^9}, 3.6821341443535643`*^9, {
   3.6822165661766434`*^9, 3.6822165740610948`*^9}, {3.6822172790817013`*^9, 
   3.6822172806755133`*^9}, {3.682218505957827*^9, 3.682218512951674*^9}, {
   3.682218926665144*^9, 3.6822189285714703`*^9}, 3.682219322560094*^9, {
   3.6822213550736437`*^9, 3.682221369951171*^9}, 3.6822236113913136`*^9, {
   3.682298410164405*^9, 3.6822984334636955`*^9}, 3.6833688212358656`*^9, {
   3.6867982274814587`*^9, 3.686798253983452*^9}, 3.6867986101485667`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"opos", "[", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", "n_"}], "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"opos", "[", 
    RowBox[{"w_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"opos", "[", 
      RowBox[{"w", ",", "n"}], "]"}], "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bw", "=", 
         RowBox[{"bb", "[", 
          RowBox[{"w", ",", "n"}], "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"opos", "[", 
         RowBox[{"bw", ",", "n"}], "]"}], "+", 
        RowBox[{"Length", "[", "bw", "]"}]}]}], "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P4", "[", 
   RowBox[{"w_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"SequencePosition", "[", 
     RowBox[{
      RowBox[{"seq", "[", "n", "]"}], ",", 
      RowBox[{"Sow", "[", 
       RowBox[{"RotateRight", "[", 
        RowBox[{
         RowBox[{"b1", "[", 
          RowBox[{"w", ",", "n"}], "]"}], ",", "i"}], "]"}], "]"}]}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"opos", "[", 
     RowBox[{"w", ",", "n"}], "]"}], "-", "i", "-", "n", "+", 
    RowBox[{"Length", "[", "w", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P4", "[", "w_", "]"}], ":=", 
   RowBox[{"And", " ", "@@", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"P4", "[", 
       RowBox[{"w", ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{
         RowBox[{"Length", "[", "w", "]"}], "-", 
         RowBox[{"LengthWhile", "[", 
          RowBox[{"w", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "\[Equal]", " ", "0"}], ")"}], "&"}]}], "]"}], "-", 
         "1"}]}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inc", "[", 
    RowBox[{"w_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{"w", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"_", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "<", "m"}], "&"}], ")"}]}], " ", "\[Rule]", "0"}], 
       ",", " ", 
       RowBox[{"m", "\[Rule]", 
        RowBox[{
         RowBox[{"w", "\[LeftDoubleBracket]", "m", "\[RightDoubleBracket]"}], 
         "+", "1"}]}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"advance", "[", 
    RowBox[{"w_", ",", "i_"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"SelectFirst", "[", " ", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"inc", "[", 
        RowBox[{"w", ",", "m"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "i", ",", "n"}], "}"}]}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{"isLyndon", "[", "#", "]"}], "&"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P5", "[", 
    RowBox[{"w_", ",", "i_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", "=", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"seq", "[", "n", "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"n", "-", "1"}]}], "]"}]}], "]"}], ",", "k"}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"SequencePosition", "[", 
         RowBox[{"s", ",", 
          RowBox[{"Sow", "[", 
           RowBox[{"RotateRight", "[", 
            RowBox[{
             RowBox[{"b1", "[", 
              RowBox[{"w", ",", "n"}], "]"}], ",", "i"}], "]"}], "]"}]}], 
         "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"opos", "[", 
         RowBox[{
          RowBox[{"u", "=", 
           RowBox[{"f3", "[", 
            RowBox[{"advance", "[", 
             RowBox[{
              RowBox[{"b1", "[", 
               RowBox[{"w", ",", "n"}], "]"}], ",", 
              RowBox[{"n", "-", "i", "+", "1"}]}], "]"}], "]"}]}], ",", "n"}],
          "]"}], "-", "i"}]}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P5", "[", "w_", "]"}], ":=", 
   RowBox[{"And", " ", "@@", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"P5", "[", 
       RowBox[{"w", ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"n", "-", 
         RowBox[{"LengthWhile", "[", 
          RowBox[{"w", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "\[Equal]", " ", "0"}], ")"}], "&"}]}], "]"}]}], 
        ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "=", 
    RowBox[{
     RowBox[{"Reap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"w", "=", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"lst", "[", "n", "]"}], ",", 
              RowBox[{
               RowBox[{"Not", "[", 
                RowBox[{"P4", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}], ")"}],
           "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"Print", "[", "\"\<P4 is true\>\"", "]"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<P4 is not true:\>\"", ",", "w"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"w", "=", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Rest", "[", 
               RowBox[{"lst", "[", "n", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"Not", "[", 
                RowBox[{"P5", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}], ")"}],
           "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"Print", "[", "\"\<P5 is true\>\"", "]"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<P5 is not true:\>\"", ",", "w"}], "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], "\[LeftDoubleBracket]", "2", 
     "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"all", "=", 
       RowBox[{"Rest", "[", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", "n"}], 
         "]"}], "]"}]}], ")"}], "\[Equal]", 
     RowBox[{"(", 
      RowBox[{"cov", "=", 
       RowBox[{"Sort", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"R", ",", "1"}], "]"}], "]"}]}], ")"}]}], ",", " ", 
    RowBox[{"Print", "[", "\"\<All tuples are covered\>\"", "]"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Not all tuples are covered:\>\"", "]"}], ";", 
     RowBox[{"Complement", "[", 
      RowBox[{"all", ",", "cov"}], "]"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"And", " ", "@@", " ", 
  RowBox[{"(", 
   RowBox[{"P4", " ", "/@", " ", 
    RowBox[{"Rest", "[", 
     RowBox[{"lst", "[", "n", "]"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"And", " ", "@@", " ", 
  RowBox[{"(", 
   RowBox[{"P5", " ", "/@", " ", 
    RowBox[{"Rest", "[", 
     RowBox[{"lst", "[", "n", "]"}], "]"}]}], 
   ")"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.681709849440483*^9, {3.6817099042250504`*^9, 3.6817101536431456`*^9}, {
   3.6817101967206593`*^9, 3.681710268553749*^9}, {3.681710332217499*^9, 
   3.681710406718654*^9}, {3.681710443130435*^9, 3.681710477545294*^9}, {
   3.6817105100671325`*^9, 3.6817105446021004`*^9}, {3.6817106048673077`*^9, 
   3.681710681153737*^9}, {3.681710717171547*^9, 3.6817107926957254`*^9}, {
   3.681710836833011*^9, 3.681710846155605*^9}, {3.681714968746125*^9, 
   3.6817151301812944`*^9}, {3.6817158556350527`*^9, 
   3.6817159632483826`*^9}, {3.6817287531761856`*^9, 3.681728753982402*^9}, {
   3.6817287870818357`*^9, 3.681728820053199*^9}, {3.6817289401354523`*^9, 
   3.6817290865647497`*^9}, {3.6817291188388987`*^9, 
   3.6817291191826534`*^9}, {3.6817291588909893`*^9, 3.681729159222249*^9}, {
   3.6817292039912767`*^9, 3.6817292298147573`*^9}, {3.6817292771142917`*^9, 
   3.681729300657316*^9}, {3.681956479561783*^9, 3.6819565251386185`*^9}, {
   3.6819676617564974`*^9, 3.6819676686945543`*^9}, {3.6819677261109223`*^9, 
   3.6819677908121767`*^9}, {3.681968334099693*^9, 3.6819683845262322`*^9}, {
   3.681984981772131*^9, 3.6819849858626633`*^9}, {3.6819850912460785`*^9, 
   3.681985113401801*^9}, {3.6819852037343254`*^9, 3.681985213853896*^9}, 
   3.6819852589117746`*^9, {3.681985301715644*^9, 3.681985352599382*^9}, {
   3.681985384883479*^9, 3.6819853902203245`*^9}, {3.6819856522952385`*^9, 
   3.68198568379811*^9}, {3.681985727929855*^9, 3.681985745524706*^9}, {
   3.6819858580835457`*^9, 3.6819858876556177`*^9}, {3.681985933144781*^9, 
   3.681985989504673*^9}, {3.681986022649852*^9, 3.681986029414854*^9}, {
   3.6819861313880715`*^9, 3.681986147534997*^9}, {3.6819861861786933`*^9, 
   3.681986204671527*^9}, {3.682057746641906*^9, 3.6820577484674287`*^9}, {
   3.6820577849565353`*^9, 3.682057874755474*^9}, {3.6820579097302027`*^9, 
   3.6820579929348383`*^9}, {3.6820580328270955`*^9, 
   3.6820580340458913`*^9}, {3.682058073402169*^9, 3.6820580907928753`*^9}, 
   3.68205817072962*^9, {3.6820582247591453`*^9, 3.682058245125575*^9}, {
   3.6820654050064487`*^9, 3.682065483881996*^9}, {3.6820655183935504`*^9, 
   3.682065519593334*^9}, {3.682065550041233*^9, 3.682065584182545*^9}, {
   3.682065628055217*^9, 3.6820657533801203`*^9}, {3.6820657944519615`*^9, 
   3.6820661104274592`*^9}, {3.6820661435260897`*^9, 3.682066171610444*^9}, {
   3.6820662095302258`*^9, 3.6820662229219775`*^9}, {3.6820662605855913`*^9, 
   3.682066311769041*^9}, {3.6820663575919876`*^9, 3.6820664684214177`*^9}, {
   3.6820665130445805`*^9, 3.6820665247242126`*^9}, {3.682066575746557*^9, 
   3.682066632450615*^9}, {3.6820666849139013`*^9, 3.682066733038352*^9}, {
   3.6820667839506245`*^9, 3.682066805837928*^9}, {3.6820668800284147`*^9, 
   3.682066880220539*^9}, {3.6820669500591807`*^9, 3.682067032392988*^9}, {
   3.68206706965734*^9, 3.6820672039891305`*^9}, {3.6820672722287264`*^9, 
   3.682067281347686*^9}, {3.6820673115394163`*^9, 3.6820673344834113`*^9}, 
   3.68206736673849*^9, {3.682067399505906*^9, 3.6820674612002244`*^9}, {
   3.682067518879919*^9, 3.6820675561592827`*^9}, {3.6820675911331387`*^9, 
   3.682067662684899*^9}, 3.682067732251363*^9, {3.6820678178012724`*^9, 
   3.6820678293528214`*^9}, {3.6820680828674994`*^9, 
   3.6820681544973116`*^9}, {3.6820681874728622`*^9, 
   3.6820682228970118`*^9}, {3.682068334206756*^9, 3.682068334894206*^9}, {
   3.68206837327729*^9, 3.682068417388118*^9}, {3.6820684575793834`*^9, 
   3.6820685279613795`*^9}, {3.682068861299225*^9, 3.6820688638108664`*^9}, {
   3.682068960545084*^9, 3.6820690139039555`*^9}, {3.6820691120941257`*^9, 
   3.682069173036953*^9}, {3.6820692337076025`*^9, 3.6820692431627827`*^9}, 
   3.682069504469553*^9, {3.682069550020322*^9, 3.682069550788824*^9}, {
   3.682069612580206*^9, 3.682069636610911*^9}, {3.6820698278879156`*^9, 
   3.6820698583508234`*^9}, {3.682069914845744*^9, 3.6820699575326414`*^9}, {
   3.6820700597724576`*^9, 3.6820700602187505`*^9}, {3.6820701625045958`*^9, 
   3.682070214886829*^9}, {3.6820702600243273`*^9, 3.6820703081807995`*^9}, {
   3.6820703448687754`*^9, 3.682070345220005*^9}, {3.6820704279390635`*^9, 
   3.682070431186186*^9}, {3.682129855725836*^9, 3.68212991025047*^9}, {
   3.682129971674612*^9, 3.682130016889161*^9}, {3.682130050457099*^9, 
   3.682130054904005*^9}, {3.6821308889670863`*^9, 3.6821309446454735`*^9}, {
   3.6821309761020308`*^9, 3.682130987253318*^9}, {3.6821310251731005`*^9, 
   3.6821310785790024`*^9}, {3.682131233104989*^9, 3.682131234399835*^9}, 
   3.6821312747822266`*^9, {3.682131566424822*^9, 3.682131624377696*^9}, {
   3.682131763908883*^9, 3.682131782468013*^9}, {3.682131868483225*^9, 
   3.6821318710258865`*^9}, 3.682131915399886*^9, {3.6821319723531075`*^9, 
   3.682132014111397*^9}, {3.682132050128935*^9, 3.682132057869994*^9}, {
   3.682132240939635*^9, 3.6821322438975687`*^9}, 3.6821324235910034`*^9, {
   3.682132455494852*^9, 3.6821324830288467`*^9}, {3.682132541973369*^9, 
   3.68213260131515*^9}, {3.6821326463385735`*^9, 3.68213280932609*^9}, {
   3.6821328683816843`*^9, 3.68213289629993*^9}, {3.682133078505005*^9, 
   3.682133129974642*^9}, {3.682133183814828*^9, 3.6821331944067497`*^9}, {
   3.6821340853630133`*^9, 3.682134119395254*^9}, {3.6822168193463154`*^9, 
   3.6822171754956117`*^9}, {3.682217336168024*^9, 3.682217341933386*^9}, {
   3.6822173752510333`*^9, 3.6822173938262997`*^9}, {3.682217737123464*^9, 
   3.682217737482859*^9}, {3.682217797411558*^9, 3.6822177978334436`*^9}, {
   3.6822178716868486`*^9, 3.6822178719368515`*^9}, {3.6822179036035957`*^9, 
   3.6822179038379717`*^9}, {3.6822179587688284`*^9, 
   3.6822179704964743`*^9}, {3.6822180032274237`*^9, 
   3.6822180035399437`*^9}, {3.6822180570667*^9, 3.682218103697445*^9}, {
   3.682218140393379*^9, 3.6822181852808104`*^9}, {3.6822182847249403`*^9, 
   3.6822182916946173`*^9}, {3.6822183358887815`*^9, 
   3.6822183756920958`*^9}, {3.6822184125540085`*^9, 3.682218442767888*^9}, {
   3.6822187004867225`*^9, 3.682218737988488*^9}, {3.6822188502877345`*^9, 
   3.682218851022138*^9}, 3.6822192595255814`*^9, {3.682219576537396*^9, 
   3.682219576896783*^9}, {3.6822196343856454`*^9, 3.6822196346981497`*^9}, {
   3.68221979719042*^9, 3.682219798909239*^9}, 3.682219897572584*^9, {
   3.682220762824334*^9, 3.6822207851233997`*^9}, {3.6822208194155817`*^9, 
   3.6822208728563175`*^9}, {3.682221296017525*^9, 3.6822213223347163`*^9}, {
   3.6822550682825575`*^9, 3.682255115151046*^9}, {3.6822551823864965`*^9, 
   3.6822554348812237`*^9}, {3.682255517871771*^9, 3.682255715527017*^9}, {
   3.682255793243198*^9, 3.682255867875566*^9}, {3.682255942025832*^9, 
   3.6822559982604227`*^9}, {3.682256075716274*^9, 3.68225607939923*^9}, {
   3.682256193587881*^9, 3.682256196023514*^9}, {3.682256233118146*^9, 
   3.682256233413223*^9}, 3.68225643332817*^9, 3.682256484109356*^9, {
   3.682256593843851*^9, 3.6822566187522535`*^9}, {3.68225665309017*^9, 
   3.682256695614212*^9}, 3.6822996961565547`*^9, 3.6823005739904428`*^9, {
   3.6823006191186447`*^9, 3.6823006231399856`*^9}, {3.682301799917406*^9, 
   3.682301804386322*^9}, {3.6823020280848007`*^9, 3.6823021753742228`*^9}, {
   3.682302244412866*^9, 3.6823022495719423`*^9}, {3.6823022970492754`*^9, 
   3.682302349198652*^9}, 3.6823024018396454`*^9, {3.682320854762684*^9, 
   3.6823208760387154`*^9}, {3.6823209688902583`*^9, 3.682320973548374*^9}, 
   3.682355771860858*^9, {3.6823558676011295`*^9, 3.6823558853431892`*^9}, 
   3.68235789733703*^9, 3.682388700461483*^9, 3.682388922604168*^9, {
   3.682905392574813*^9, 3.682905409807389*^9}, {3.683349934503173*^9, 
   3.683349946621305*^9}, {3.6833712627445*^9, 3.6833712733032227`*^9}, 
   3.6833718263156977`*^9, {3.6834579843056884`*^9, 3.683458061310483*^9}, {
   3.683458173594632*^9, 3.683458269814602*^9}, {3.6847507727785234`*^9, 
   3.684750773013672*^9}, {3.6865657110190277`*^9, 3.6865657706357565`*^9}, {
   3.6867985221641192`*^9, 3.6867985226900587`*^9}, {3.6867990965702705`*^9, 
   3.6867990981743736`*^9}, {3.686799675327657*^9, 3.686799756139864*^9}, {
   3.6867998833204527`*^9, 3.686799896503806*^9}, {3.6867999295577507`*^9, 
   3.6867999500357265`*^9}, {3.6867999894917283`*^9, 3.686800060961015*^9}, {
   3.6868001410537663`*^9, 3.686800150269606*^9}, {3.6868002281219373`*^9, 
   3.6868002569041753`*^9}, 3.6868003233342695`*^9, 3.686800476143097*^9, {
   3.6868005260777383`*^9, 3.686800595514737*^9}, {3.686800639304485*^9, 
   3.686800642073239*^9}, {3.686801250648085*^9, 3.6868012573949337`*^9}, 
   3.686801327694984*^9, {3.6868014110706654`*^9, 3.68680144652772*^9}, {
   3.6868015577989855`*^9, 3.686801584738104*^9}, {3.6868016799211855`*^9, 
   3.686801756557108*^9}, {3.6868018029782686`*^9, 3.686801803150148*^9}, {
   3.6868018838183823`*^9, 3.6868019129690466`*^9}, {3.686803233678297*^9, 
   3.6868032445491095`*^9}, {3.686803291943751*^9, 3.6868036451341505`*^9}, {
   3.686803784926214*^9, 3.6868038112255244`*^9}, {3.6868041158717904`*^9, 
   3.686804116513343*^9}, {3.686806137292353*^9, 3.6868061375987673`*^9}, {
   3.686807724708577*^9, 3.686807842959014*^9}, {3.6868081031978197`*^9, 
   3.686808111311498*^9}, {3.6868087078757935`*^9, 3.6868087090866385`*^9}}],

Cell[BoxData[
 RowBox[{"bb", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", "4"}], "]"}]], "Input",
 CellChangeTimes->{{3.6868087244703016`*^9, 3.686808734160343*^9}, {
  3.686808770318042*^9, 3.686808799336869*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"form", "=", 
    RowBox[{"FormPage", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<n\>\"", "\[Rule]", "\"\<Integer\>\""}], ",", 
        RowBox[{"\"\<word\>\"", "\[Rule]", 
         RowBox[{"Restricted", "[", 
          RowBox[{"\"\<String\>\"", ",", 
           RowBox[{"RegularExpression", "[", "\"\<[0-9]+\>\"", "]"}]}], 
          "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"w", "=", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"Characters", "[", "#word", "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"n", "=", "#n"}], ";", "\[IndentingNewLine]", 
          RowBox[{"rep", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"Highlighted", "[", 
                RowBox[{
                 RowBox[{"seq", "[", "n", "]"}], "\[LeftDoubleBracket]", "#", 
                 "\[RightDoubleBracket]"}], "]"}]}], ")"}], "&"}], " ", "/@", 
            " ", 
            RowBox[{"(", 
             RowBox[{"Range", "@@", 
              RowBox[{"(", 
               RowBox[{"p", "=", 
                RowBox[{
                 RowBox[{"SequencePosition", "[", 
                  RowBox[{
                   RowBox[{"seq", "[", "n", "]"}], ",", "w"}], "]"}], 
                 "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
               ")"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"fseq", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{
             RowBox[{"seq", "[", "n", "]"}], ",", "rep"}], " ", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Row", " ", "@", " ", 
           RowBox[{"Insert", "[", 
            RowBox[{"fseq", ",", "\"\<|\>\"", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", "#", "}"}], "&"}], " ", "/@", " ", 
               RowBox[{"Most", "[", 
                RowBox[{"dev", "[", "n", "]"}], "]"}]}], "+", "1"}]}], 
            "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "&"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"CloudDeploy", "[", 
  RowBox[{
   RowBox[{"form", "[", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<n\>\"", "\[Rule]", "4"}], ",", 
      RowBox[{"\"\<word\>\"", "\[Rule]", "\"\<0101\>\""}], ",", " ", 
      RowBox[{"\"\<Shift\>\"", "\[Rule]", "1"}]}], "|>"}], "]"}], ",", 
   "\"\<Highlighter\>\"", ",", 
   RowBox[{"Permissions", "\[Rule]", "\"\<Public\>\""}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6817183354017477`*^9, 3.68171868478507*^9}, {
   3.681718718504737*^9, 3.6817188363155785`*^9}, 3.681718895355111*^9, {
   3.6817189814801617`*^9, 3.681718984421155*^9}, 3.68171902168766*^9, 
   3.6817190598434353`*^9, 3.6817191136978197`*^9, {3.6817191468222237`*^9, 
   3.681719182663783*^9}, {3.6817192223309145`*^9, 3.681719255675904*^9}, {
   3.6817192900565305`*^9, 3.681719419382022*^9}, {3.681719465969874*^9, 
   3.6817194996321926`*^9}, {3.681719540327318*^9, 3.6817195407335835`*^9}, {
   3.6817195950618267`*^9, 3.6817197447650213`*^9}, {3.681719777423797*^9, 
   3.681719824854007*^9}, {3.6817198559500675`*^9, 3.6817198569958396`*^9}, {
   3.6817198906861973`*^9, 3.681719896104148*^9}, {3.681721011178234*^9, 
   3.681721126083798*^9}, {3.6817211813021326`*^9, 3.681721225404923*^9}, {
   3.681721256143613*^9, 3.6817213147364564`*^9}, {3.6817213588030376`*^9, 
   3.681721604144683*^9}, {3.6817216809443693`*^9, 3.681721710208126*^9}, {
   3.681721772531145*^9, 3.681721803425869*^9}, {3.681721855848197*^9, 
   3.681721859826895*^9}, {3.681721897518694*^9, 3.681721939155429*^9}, {
   3.68172198725016*^9, 3.6817220009066935`*^9}, {3.6823211217955265`*^9, 
   3.6823211363960657`*^9}, {3.6823211668494034`*^9, 3.682321167396297*^9}, {
   3.6823212254894505`*^9, 3.682321232530776*^9}, {3.6823212658482833`*^9, 
   3.6823213670692716`*^9}, {3.682321408715696*^9, 3.6823214586342235`*^9}, {
   3.6823230793736725`*^9, 3.6823231209080105`*^9}, {3.682323160636058*^9, 
   3.6823232346910253`*^9}, {3.682323288136777*^9, 3.6823233388229294`*^9}, {
   3.6823233696352315`*^9, 3.68232341041676*^9}, {3.683344023586512*^9, 
   3.683344042710661*^9}, {3.683344073783734*^9, 3.6833440762343698`*^9}, {
   3.6833441708497624`*^9, 3.683344171799018*^9}, 3.6833442053008204`*^9, {
   3.6833451476503344`*^9, 3.6833451482534885`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"comp", "[", 
   RowBox[{"l1_", ",", "l2_"}], "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{"l1", ",", 
    RowBox[{
     RowBox[{"Not", "[", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"l2", ",", "#"}], "]"}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyc", "[", 
   RowBox[{"n_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"comp", "[", 
   RowBox[{
    RowBox[{"Subsequences", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"seq", "[", "n", "]"}], ",", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"seq", "[", "n", "]"}], ",", 
          RowBox[{"n", "-", "1"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "n", "}"}]}], "]"}], ",", 
    RowBox[{"Union", " ", "@@", 
     RowBox[{"(", " ", 
      RowBox[{"rotations", " ", "/@", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"b1", "[", 
           RowBox[{"#", ",", "n"}], "]"}], "&"}], " ", "/@", " ", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"lst", "[", "n", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"k", "+", "1"}], ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ")"}]}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hcyc", "[", 
    RowBox[{"n_", ",", "k_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Row", " ", "/@", " ", 
      RowBox[{"cyc", "[", 
       RowBox[{"n", ",", "k"}], "]"}]}], ")"}], "/.", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Row", "[", "#", "]"}], "\[Rule]", 
         RowBox[{"Highlighted", "[", 
          RowBox[{"Row", "[", "#", "]"}], "]"}]}], ")"}], "&"}], " ", "/@", 
      " ", 
      RowBox[{"rotations", "[", 
       RowBox[{"b1", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"lst", "[", "n", "]"}], "\[LeftDoubleBracket]", "k", 
          "\[RightDoubleBracket]"}], ",", "n"}], "]"}], "]"}]}], ")"}]}]}], 
  " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isShifts", "[", "l_", "]"}], ":=", 
  RowBox[{"And", " ", "@@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"RotateRight", "[", 
          RowBox[{"l", "\[LeftDoubleBracket]", 
           RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "]"}], ",", 
         RowBox[{"1", "\[Rule]", " ", "_"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Length", "[", "l", "]"}], "-", "1"}]}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"And", " ", "@@", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"isShifts", "[", 
      RowBox[{"cyc", "[", 
       RowBox[{"4", ",", "i"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "24"}], "}"}]}], "]"}]}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Column", "[", 
     RowBox[{"hcyc", "[", 
      RowBox[{"4", ",", "i"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "9"}], "}"}]}], "]"}], "  "}]}], "Input",
 CellChangeTimes->{{3.681896949842039*^9, 3.681897042321001*^9}, {
   3.681897087674243*^9, 3.6818972673721523`*^9}, {3.681897361358302*^9, 
   3.6818974281878705`*^9}, {3.681897489365201*^9, 3.6818977931754036`*^9}, {
   3.6818978516771464`*^9, 3.6818978778678937`*^9}, {3.681897926178877*^9, 
   3.6818979543161163`*^9}, {3.6818980979626255`*^9, 
   3.6818981035791364`*^9}, {3.6819014347678795`*^9, 3.681901473965417*^9}, {
   3.68190187825021*^9, 3.6819019473895283`*^9}, {3.6819020210228586`*^9, 
   3.6819020304611735`*^9}, {3.681902089716555*^9, 3.6819020923615036`*^9}, {
   3.6819021721357875`*^9, 3.6819021846943893`*^9}, {3.6819022369060497`*^9, 
   3.68190224230859*^9}, 3.6819023101905746`*^9, {3.6819563931960545`*^9, 
   3.6819564513985925`*^9}, {3.681956551278912*^9, 3.6819565961104174`*^9}, {
   3.681956807286838*^9, 3.681956810723878*^9}, {3.6819568409764233`*^9, 
   3.6819568415045652`*^9}, {3.681956904241473*^9, 3.6819569496461773`*^9}, {
   3.68195702007076*^9, 3.6819571520675287`*^9}, {3.681957187157877*^9, 
   3.68195723541059*^9}, {3.681957288488269*^9, 3.681957401624517*^9}, {
   3.6819608915846853`*^9, 3.681960906351548*^9}, {3.681963742420019*^9, 
   3.681963764434952*^9}, {3.681963834615143*^9, 3.681963867764886*^9}, 
   3.6834258204282274`*^9, 3.6834266336459312`*^9, {3.6865644229605317`*^9, 
   3.6865644239293003`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6818976839935827`*^9, 3.6818976880956736`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6818976518328495`*^9, 3.6818976532215652`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"anchor", "[", 
    RowBox[{"w_", ",", "n_", ",", "l_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"RotateLeft", "[", 
        RowBox[{
         RowBox[{"b1", "[", 
          RowBox[{
           RowBox[{"bb", "[", 
            RowBox[{"w", ",", "n"}], "]"}], ",", "n"}], "]"}], ",", "l"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"n", "-", "l"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "l"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addCycle", "[", 
    RowBox[{"c1_", ",", "w_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", "=", 
       RowBox[{"LengthWhile", "[", 
        RowBox[{"w", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "\[Equal]", "0"}], ")"}], "&"}]}], "]"}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"c1", ",", 
           RowBox[{"anchor", "[", 
            RowBox[{"w", ",", "n", ",", "l"}], "]"}]}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", ")"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Take", "[", 
         RowBox[{"c1", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "p"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RotateLeft", "[", 
         RowBox[{
          RowBox[{"rotations", "[", 
           RowBox[{"b1", "[", 
            RowBox[{"w", ",", "n"}], "]"}], "]"}], ",", 
          RowBox[{"l", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Take", "[", 
         RowBox[{"c1", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p", "+", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"words", "=", 
    RowBox[{"NestList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ff", "[", 
        RowBox[{"#", ",", "n"}], "]"}], "&"}], ",", 
      RowBox[{"{", "0", "}"}], ",", "100"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sss", "[", "i_", "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"Join", "@@", " ", 
     RowBox[{"Take", "[", 
      RowBox[{"words", ",", "i"}], "]"}]}], ",", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"n", "-", "1"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expected", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Subsequences", "[", 
      RowBox[{
       RowBox[{"sss", "[", "i", "]"}], ",", 
       RowBox[{"{", "n", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "words", "]"}]}], "}"}]}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mine", "=", 
   RowBox[{"FoldList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"addCycle", "[", 
       RowBox[{"#1", ",", "#2", ",", "n"}], "]"}], "&"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "n"}], "]"}], "}"}], ",", 
     RowBox[{"Rest", "[", "words", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mine", "==", "expected"}]}], "Input",
 CellChangeTimes->{{3.6819580545628333`*^9, 3.6819581050780635`*^9}, {
   3.6819600747980785`*^9, 3.6819602384810004`*^9}, {3.68196083556822*^9, 
   3.681960836464243*^9}, {3.6819610329564767`*^9, 3.6819612627717223`*^9}, {
   3.6819612986526732`*^9, 3.6819613278628445`*^9}, {3.6819613753654127`*^9, 
   3.681961378871522*^9}, {3.681961411201623*^9, 3.6819615632159615`*^9}, {
   3.6819616089852133`*^9, 3.681961622064294*^9}, {3.681961652768033*^9, 
   3.6819616571683235`*^9}, {3.6819617004678993`*^9, 3.681961732167627*^9}, {
   3.681962424908568*^9, 3.6819626650663505`*^9}, {3.6819626953381023`*^9, 
   3.681962781124299*^9}, {3.68196291968867*^9, 3.6819637199505067`*^9}, {
   3.681963905630136*^9, 3.681963935840328*^9}, {3.6819639972949796`*^9, 
   3.6819640267478304`*^9}, {3.6819816367320147`*^9, 
   3.6819816452999983`*^9}, {3.681981690556566*^9, 3.6819817821894464`*^9}, {
   3.681981814681383*^9, 3.681981838266337*^9}, {3.6819820546145067`*^9, 
   3.6819820808182735`*^9}, {3.681982129969037*^9, 3.6819821466769495`*^9}, {
   3.6819821916137247`*^9, 3.6819821938677797`*^9}, {3.681982239810413*^9, 
   3.6819823191574116`*^9}, {3.681982357785205*^9, 3.681982576206992*^9}, {
   3.6819826100524535`*^9, 3.681982624729081*^9}, 3.6819827021456785`*^9, {
   3.6819833883772335`*^9, 3.681983398870566*^9}, {3.6819834553478003`*^9, 
   3.681983478107296*^9}, {3.6819835265279675`*^9, 3.681983595394701*^9}, {
   3.681984492296756*^9, 3.6819846417077937`*^9}, {3.682356093913757*^9, 
   3.682356094924752*^9}, {3.6825610591282015`*^9, 3.682561069030342*^9}, {
   3.6825611158863535`*^9, 3.68256111641763*^9}, {3.682563064612297*^9, 
   3.6825631158548727`*^9}, {3.6834259784478045`*^9, 3.6834259788696833`*^9}, 
   3.6834260135585403`*^9, {3.6834260787482805`*^9, 3.6834260889166718`*^9}, 
   3.683426144516718*^9, {3.6847508095388165`*^9, 3.6847508100341296`*^9}, 
   3.686565316156354*^9, 3.6865653896863713`*^9, {3.6869803646363325`*^9, 
   3.6869803690627317`*^9}}],

Cell[BoxData[
 RowBox[{"anchor", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", "4", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.6869800791746273`*^9, 3.686980099203747*^9}, {
  3.6869807389231663`*^9, 3.686980740603317*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hcyc", "[", 
    RowBox[{"n_", ",", "k_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ToString", " ", "[", "#", "]"}], "<>", "\"\<,\>\""}], "&"}], 
      "/@", " ", 
      RowBox[{"Row", "/@", " ", 
       RowBox[{"cyc", "[", 
        RowBox[{"n", ",", "k"}], "]"}]}]}], ")"}], "/.", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"Row", "[", "#", "]"}], "]"}], "<>", "\"\<,\>\""}], 
         "\[Rule]", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"Row", "[", "#", "]"}], "]"}], "<>", "\"\<,\>\""}], ",", 
           "Blue"}], "]"}]}], ")"}], "&"}], " ", "/@", " ", 
      RowBox[{"rotations", "[", 
       RowBox[{"b1", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"lst", "[", "n", "]"}], "\[LeftDoubleBracket]", "k", 
          "\[RightDoubleBracket]"}], ",", "n"}], "]"}], "]"}]}], ")"}]}]}], 
  " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"form", "=", 
    RowBox[{"FormPage", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<n\>\"", "\[Rule]", "\"\<Integer\>\""}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<k\>\"", ",", "\"\<Cycle index\>\""}], "}"}], 
         "\[Rule]", "\"\<Integer\>\""}]}], "}"}], ",", "\[IndentingNewLine]", 
      " ", 
      RowBox[{
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"hcyc", "[", 
            RowBox[{"#n", ",", "i"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "#k"}], "}"}]}], "]"}], ",", 
         RowBox[{"Dividers", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}]}], "]"}], "&"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"CloudDeploy", "[", 
  RowBox[{
   RowBox[{"form", "[", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<n\>\"", "\[Rule]", "4"}], ",", 
      RowBox[{"\"\<k\>\"", "\[Rule]", "5"}]}], "|>"}], "]"}], ",", 
   "\"\<Cycle join\>\"", ",", 
   RowBox[{"Permissions", "\[Rule]", "\"\<Public\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQ/a9iX9j7/NeOx+4figDR0wTVjk8ufO0ofG7aRRD9
9OvCryB6xTtlzilA+sqrJn4QPa/tlxCI3m1vJAGi1yz+LAuiQ54bqYBoMZ75
qiBaQIbpJIg+8MjsFIjusS26CKLrLjlcAdG7qh1vgWjm0vVg+kaz2hMQfent
/Ocgus1g13sQveMOm+RUIF20zcMbRPPOiQ4C0c8ynk6fDaT/z3dYBKKLFrB8
BdHq34oZ5gDpFsPbLCCaTeWBAIiuenBWDERv2lYvDqJnSHjKgOiFEkFgesfP
aGUQrSI23wBMn+M3BdEv5PbagGgdiUp/EP3l2O5AEJ2RNTUeRLOwu1SD6La+
pEYQLVBdCqYBQ1635w==
  "]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", "[", "w_", "]"}], ":=", 
  RowBox[{"LengthWhile", "[", 
   RowBox[{"w", ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "\[Equal]", "0"}], ")"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test", "[", "w_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Rest", "[", 
    RowBox[{"Sow", "[", 
     RowBox[{"anchor", "[", 
      RowBox[{"w", ",", "n", ",", 
       RowBox[{"l", "[", "w", "]"}]}], "]"}], "]"}], "]"}], "\[Equal]", 
   RowBox[{"Rest", "[", 
    RowBox[{"Sow", "[", 
     RowBox[{"RotateRight", "[", 
      RowBox[{
       RowBox[{"b1", "[", 
        RowBox[{"w", ",", "n"}], "]"}], ",", 
       RowBox[{
        RowBox[{"l", "[", "w", "]"}], "+", 
        RowBox[{"Length", "[", "w", "]"}]}]}], "]"}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Reap", "[", 
  RowBox[{"test", "[", "w", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6871680373967934`*^9, 3.687168213890629*^9}, {
  3.6871684890099597`*^9, 3.6871685605432873`*^9}, {3.6871686237403316`*^9, 
  3.6871686807464542`*^9}, {3.687168808469386*^9, 3.687168829476698*^9}, {
  3.6871693955333815`*^9, 3.6871693959006147`*^9}, {3.6871694365553756`*^9, 
  3.6871694547148824`*^9}, {3.6871698723615255`*^9, 3.6871699495264225`*^9}}]
},
WindowSize->{1676, 967},
WindowMargins->{{Automatic, -4}, {Automatic, 0}},
Magnification:>1.2 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 6447, 185, 522, "Input"],
Cell[7008, 207, 7657, 186, 542, "Input"],
Cell[14668, 395, 4736, 96, 304, "Input"],
Cell[19407, 493, 7658, 149, 446, "Input"],
Cell[27068, 644, 5281, 105, 182, "Input"],
Cell[32352, 751, 17217, 363, 758, "Input"],
Cell[49572, 1116, 244, 6, 54, "Input"],
Cell[49819, 1124, 4677, 96, 438, "Input"],
Cell[54499, 1222, 4765, 123, 298, "Input"],
Cell[59267, 1347, 96, 1, 54, "Input"],
Cell[59366, 1350, 96, 1, 54, "Input"],
Cell[59465, 1353, 5925, 144, 855, "Input"],
Cell[65393, 1499, 260, 6, 54, "Input"],
Cell[65656, 1507, 2887, 81, 333, "Input"],
Cell[68546, 1590, 1484, 40, 194, "Input"]
}
]
*)

