(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     96028,       2296]
NotebookOptionsPosition[     94261,       2233]
NotebookOutlinePosition[     94634,       2249]
CellTagsIndexPosition[     94591,       2246]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", "[", "w_", "]"}], ":=", " ", 
  RowBox[{"w", "/.", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d_", ",", "x___"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d", "+", "1"}], ",", "x"}], "}"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "[", 
   RowBox[{"w_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"PadLeft", "[", 
   RowBox[{"w", ",", "n"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f3", "[", "w_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"w", " ", "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Longest", "[", "uu__", "]"}], ",", "vv__", ",", "uu__"}], 
        "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"vv", ",", "uu"}], "}"}]}]}], ")"}], " ", "/.", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"uu__", ".."}], "}"}], "\[Rule]", 
     RowBox[{"{", "uu", "}"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"w_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"f3", "[", 
   RowBox[{"f2", "[", 
    RowBox[{
     RowBox[{"f1", "[", "w", "]"}], ",", "n"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ff", "[", 
    RowBox[{"w_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"NestWhile", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"#", ",", "n"}], "]"}], "&"}], ",", 
     RowBox[{"f", "[", 
      RowBox[{"w", ",", "n"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Not", "[", 
       RowBox[{"Divisible", "[", 
        RowBox[{"n", ",", 
         RowBox[{"Length", "[", "#", "]"}]}], "]"}], "]"}], "&"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", "[", 
   RowBox[{"w_", ",", "n_"}], "]"}], ":=", " ", 
  RowBox[{"Take", "[", 
   RowBox[{
    RowBox[{"Join", " ", "@@", " ", 
     RowBox[{"Array", "[", 
      RowBox[{
       RowBox[{"w", "&"}], ",", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"n", "/", 
         RowBox[{"Length", "[", "w", "]"}]}], "]"}]}], "]"}]}], ",", 
    RowBox[{"-", "n"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", "[", "w_", "]"}], ":=", " ", 
  RowBox[{"w", "/.", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Longest", "[", 
       RowBox[{
        RowBox[{"(", "0", ")"}], ".."}], "]"}], ",", "x__"}], "}"}], 
    "\[Rule]", 
    RowBox[{"{", "x", "}"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b3", "[", "w_", "]"}], ":=", " ", 
   RowBox[{"w", "/.", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d_", ",", "x___"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"d", "-", "1"}], ",", "x"}], "}"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "[", 
   RowBox[{"w_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"b3", "[", 
   RowBox[{"b2", "[", 
    RowBox[{"b1", "[", 
     RowBox[{"w", ",", "n"}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bb", "[", 
    RowBox[{"w_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"NestWhile", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"b", "[", 
       RowBox[{"#", ",", "n"}], "]"}], "&"}], ",", 
     RowBox[{"b", "[", 
      RowBox[{"w", ",", "n"}], "]"}], ",", 
     RowBox[{
      RowBox[{"Not", "[", 
       RowBox[{"Divisible", "[", 
        RowBox[{"n", ",", 
         RowBox[{"Length", "[", "#", "]"}]}], "]"}], "]"}], "&"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k", "=", "4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lst", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"lst", "[", "n", "]"}], "=", 
   RowBox[{"NestWhileList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ff", "[", 
       RowBox[{"#", ",", "n"}], "]"}], "&"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{
      RowBox[{"#", "\[NotEqual]", 
       RowBox[{"{", 
        RowBox[{"k", "-", "1"}], "}"}]}], "&"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"seq", "[", "n_", "]"}], ":=", 
    RowBox[{
     RowBox[{"seq", "[", "n", "]"}], "=", " ", 
     RowBox[{"Join", "@@", 
      RowBox[{"lst", "[", "n", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bseq", "[", "n_", "]"}], " ", ":=", 
   RowBox[{"Join", " ", "@@", " ", 
    RowBox[{"Reverse", "[", 
     RowBox[{"NestWhileList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"bb", "[", 
         RowBox[{"#", ",", "n"}], "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", "-", "1"}], "}"}], ",", 
       RowBox[{
        RowBox[{"#", "\[NotEqual]", 
         RowBox[{"{", "0", "}"}]}], "&"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bseq", "[", "n", "]"}], "==", 
  RowBox[{"seq", "[", "n", "]"}]}]}], "Input",
 CellChangeTimes->{
  3.6812343385950136`*^9, {3.6812343738408*^9, 3.6812344062205524`*^9}, {
   3.681234472208804*^9, 3.681234486030609*^9}, 3.681234591933275*^9, {
   3.6812350099369373`*^9, 3.6812350408702183`*^9}, {3.681235318278736*^9, 
   3.6812353200346546`*^9}, {3.681235895799814*^9, 3.681235896697755*^9}, {
   3.6812359272082043`*^9, 3.681235934879717*^9}, {3.6812368799348383`*^9, 
   3.6812368961979017`*^9}, {3.681236937736692*^9, 3.6812369412067266`*^9}, {
   3.6812394318586287`*^9, 3.6812394386338162`*^9}, {3.6812402321830063`*^9, 
   3.6812402350981364`*^9}, {3.681284857122822*^9, 3.6812848609786463`*^9}, {
   3.6812900845324564`*^9, 3.6812901289896297`*^9}, {3.681319972735944*^9, 
   3.6813199737963333`*^9}, {3.68140201638933*^9, 3.681402095029662*^9}, {
   3.6814023951337824`*^9, 3.681402420929696*^9}, {3.6814025639707747`*^9, 
   3.6814025676765027`*^9}, 3.6814029191413994`*^9, {3.681403401842312*^9, 
   3.6814034328818254`*^9}, {3.6814037201096683`*^9, 3.681403806476817*^9}, {
   3.681404803275767*^9, 3.6814048711381655`*^9}, 3.6816115597326756`*^9, {
   3.6819568823792295`*^9, 3.6819568963946657`*^9}, 3.681982992267831*^9, {
   3.681983030907017*^9, 3.681983094302966*^9}, {3.681983279050273*^9, 
   3.681983304437924*^9}, {3.682220615186222*^9, 3.6822206580684304`*^9}, {
   3.6822464761656*^9, 3.682246488867901*^9}, {3.683343298682266*^9, 
   3.683343334773266*^9}}],

Cell[BoxData[
 FormBox["True", TraditionalForm]], "Output",
 CellChangeTimes->{
  3.68196808598643*^9, 3.681982818316434*^9, 3.681982992832816*^9, 
   3.6819830958443813`*^9, 3.681983191976688*^9, {3.681983279624565*^9, 
   3.6819833048441815`*^9}, 3.681985913442342*^9, 3.6820580036369343`*^9, 
   3.682132112072418*^9, 3.682133144120887*^9, {3.682220629028301*^9, 
   3.6822206592882557`*^9}, 3.682220727471574*^9, 3.682246379132187*^9, 
   3.682246490309844*^9, 3.682255082280176*^9, 3.6822984130074005`*^9, {
   3.6823557400386405`*^9, 3.6823557595640965`*^9}, 3.682393605622569*^9, 
   3.6823937538753767`*^9, 3.6823941784553614`*^9, 3.682394210042246*^9, 
   3.682853344360691*^9, 3.682905338400674*^9, 3.6833433402726927`*^9, 
   3.6833451569757414`*^9, 3.683371570487814*^9, 3.6834249032074776`*^9, 
   3.683426036196844*^9, 3.683426150001195*^9, 3.6847506622885103`*^9, {
   3.6847507980215197`*^9, 3.6847508143638735`*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dev", "[", "n_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"dev", "[", "n", "]"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"s", "=", "0"}], ";", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"s", "+=", 
           RowBox[{"Length", "[", "#", "]"}]}], ")"}], "&"}], " ", "/@", " ", 
        RowBox[{"lst", "[", "n", "]"}]}]}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rotations", "[", "w_", "]"}], ":=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"NestList", "[", 
     RowBox[{"RotateLeft", ",", "w", ",", 
      RowBox[{
       RowBox[{"Length", "[", "w", "]"}], "-", "1"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"val", "[", "w_", "]"}], ":=", 
  RowBox[{"ToString", "[", 
   RowBox[{"Reverse", "[", "w", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toLyndon", "[", "w_", "]"}], ":=", 
   RowBox[{
    RowBox[{"MaximalBy", "[", 
     RowBox[{
      RowBox[{"rotations", "[", "w", "]"}], ",", "val"}], "]"}], 
    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isLyndon", "[", "w_", "]"}], ":=", 
  RowBox[{
   RowBox[{"toLyndon", "[", "w", "]"}], "\[Equal]", 
   "w"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lyndonIndex", "[", "w_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{
       RowBox[{"rotations", "[", 
        RowBox[{"toLyndon", "[", "w", "]"}], "]"}], ",", "w"}], "]"}], 
     "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "-", "1"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"canIncrease", "[", "w_", "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"l", "=", 
        RowBox[{"toLyndon", "[", "w", "]"}]}], ",", 
       RowBox[{"i", "=", 
        RowBox[{"lyndonIndex", "[", "w", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"i", "+", "1"}], "\[Equal]", "n"}], "\[Or]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"l", "\[LeftDoubleBracket]", 
          RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "\[NotEqual]", 
         RowBox[{"Max", "[", "w", "]"}]}], "\[And]", 
        RowBox[{"isLyndon", "[", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"l", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "+", "1"}], ")"}], "\[Rule]", 
            RowBox[{
             RowBox[{"l", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "+", 
             "1"}]}]}], " ", "]"}], "]"}]}], ")"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"canIncrease", "[", "w_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ww", "=", 
      RowBox[{"toLyndon", "[", "w", "]"}]}], ";", 
     RowBox[{"i", "=", 
      RowBox[{"lyndonIndex", "[", "w", "]"}]}], ";", 
     RowBox[{"www", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"ww", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "+", "1"}], ")"}], "\[Rule]", 
         RowBox[{
          RowBox[{"ww", "\[LeftDoubleBracket]", 
           RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "+", "1"}]}]}],
        " ", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"i", "+", "1"}], "\[Equal]", "n"}], "\[Or]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"ww", "\[LeftDoubleBracket]", 
          RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "\[NotEqual]", 
         RowBox[{"Max", "[", "w", "]"}]}], "\[And]", 
        RowBox[{"isLyndon", "[", "www", "]"}]}], ")"}]}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"canIncrease", "[", "w_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ww", "=", 
      RowBox[{"toLyndon", "[", "w", "]"}]}], ";", 
     RowBox[{"i", "=", 
      RowBox[{"lyndonIndex", "[", "w", "]"}]}], ";", 
     RowBox[{"www", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"ww", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "+", "1"}], ")"}], "\[Rule]", 
         RowBox[{
          RowBox[{"ww", "\[LeftDoubleBracket]", 
           RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "+", "1"}]}]}],
        " ", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"Most", "[", "www", "]"}], "]"}], "\[LessEqual]", " ", 
       RowBox[{"Max", "[", "w", "]"}]}], "\[And]", 
      RowBox[{"isLyndon", "[", "www", "]"}]}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"trailingZ", "[", "w_", "]"}], ":=", 
  RowBox[{"And", " ", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"#", "\[Equal]", "0"}], ")"}], "&"}], "  ", "/@", 
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"toLyndon", "[", "w", "]"}], ",", 
       RowBox[{"lyndonIndex", "[", "w", "]"}]}], "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.681103547464664*^9, 3.6811036836729593`*^9}, {
   3.681103767456843*^9, 3.681103786858462*^9}, {3.6811040348428736`*^9, 
   3.681104071048169*^9}, {3.681104189812095*^9, 3.681104195290648*^9}, {
   3.681104509834357*^9, 3.681104552397544*^9}, {3.6811085609323435`*^9, 
   3.681108564436673*^9}, {3.6811086132915974`*^9, 3.6811086141900206`*^9}, {
   3.681124493898198*^9, 3.6811244943965235`*^9}, 3.6811262999822145`*^9, {
   3.68112650790829*^9, 3.6811265634219604`*^9}, {3.681126593938162*^9, 
   3.681126610671637*^9}, {3.681144184461918*^9, 3.681144186368018*^9}, 
   3.6811442536399527`*^9, {3.6811771534066963`*^9, 3.681177154642088*^9}, {
   3.681178007154801*^9, 3.681178017987858*^9}, {3.681178924720995*^9, 
   3.681178959180601*^9}, {3.681179328095487*^9, 3.6811793286505446`*^9}, {
   3.681179737943857*^9, 3.681179766686838*^9}, {3.6812339578399973`*^9, 
   3.681233958464327*^9}, {3.6812341064550867`*^9, 3.6812341202875643`*^9}, {
   3.6812341547639294`*^9, 3.681234192094988*^9}, {3.681234324346789*^9, 
   3.6812343246787634`*^9}, {3.6812351122410126`*^9, 
   3.6812351128402567`*^9}, {3.6812351666190577`*^9, 
   3.6812351674250565`*^9}, {3.681235257865267*^9, 3.6812353086679316`*^9}, {
   3.6812353478749056`*^9, 3.6812353626443977`*^9}, {3.6812354229909515`*^9, 
   3.68123547840138*^9}, {3.681404890667019*^9, 3.681404890808956*^9}, {
   3.6814049260596523`*^9, 3.681404936753445*^9}, {3.681572771580958*^9, 
   3.6815727989585238`*^9}, 3.6815729100952387`*^9, {3.681611797682182*^9, 
   3.6816118039692907`*^9}, {3.682221981529203*^9, 3.682221981872974*^9}, {
   3.6823567927065315`*^9, 3.682356834773063*^9}, {3.6823568894872184`*^9, 
   3.6823569097719917`*^9}, {3.6823569411690855`*^9, 
   3.6823570206953845`*^9}, {3.682390291628702*^9, 3.6823902982814274`*^9}, {
   3.6823927673284254`*^9, 3.682392813582635*^9}, {3.6823929395719724`*^9, 
   3.682392975596858*^9}, {3.6823930270151463`*^9, 3.6823931573118544`*^9}, {
   3.682393208023761*^9, 3.6823933730320444`*^9}, {3.682393420877141*^9, 
   3.6823934510166883`*^9}, {3.6823935788625574`*^9, 3.682393579526467*^9}, {
   3.682393855656685*^9, 3.6823938736681347`*^9}, {3.6823940175376945`*^9, 
   3.682394154781617*^9}, 3.682394194930356*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "nxt", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nxt", "[", "w_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ff", "[", 
      RowBox[{
       RowBox[{"f3", "[", "w", "]"}], ",", "n"}], "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ")"}], " ", "/;",
    " ", 
   RowBox[{"isLyndon", "[", "w", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nxt", "[", "w_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"w", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
    "1"}], " ", "/;", " ", 
   RowBox[{
    RowBox[{"trailingZ", "[", "w", "]"}], " ", "\[And]", 
    RowBox[{"canIncrease", "[", "w", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nxt", "[", "w_", "]"}], ":=", 
  RowBox[{"0", "/;", " ", 
   RowBox[{
    RowBox[{"trailingZ", "[", "w", "]"}], " ", "\[And]", 
    RowBox[{"Not", "[", 
     RowBox[{"canIncrease", "[", "w", "]"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nxt", "[", "w_", "]"}], ":=", 
   RowBox[{"w", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myseq", "=", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "n"}], "]"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"AppendTo", " ", "[", 
     RowBox[{"myseq", ",", " ", 
      RowBox[{"nxt", "[", 
       RowBox[{"Take", "[", 
        RowBox[{"myseq", ",", 
         RowBox[{"-", "n"}]}], "]"}], "]"}]}], "]"}], " ", ",", 
    RowBox[{
     SuperscriptBox["k", "n"], "-", "n", "-", "1"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"myseq", "==", 
  RowBox[{"seq", "[", "n", "]"}]}]}], "Input",
 CellChangeTimes->{{3.681124209600976*^9, 3.681124268397375*^9}, {
   3.681124326060757*^9, 3.681124348452318*^9}, {3.6811243868173666`*^9, 
   3.681124438496834*^9}, {3.6811245483751063`*^9, 3.681124553629081*^9}, {
   3.6811246189067173`*^9, 3.6811246334032784`*^9}, {3.681125297454528*^9, 
   3.681125463947387*^9}, {3.6811255580236316`*^9, 3.6811256016837673`*^9}, {
   3.681125645221571*^9, 3.6811256685877576`*^9}, {3.6811257276317787`*^9, 
   3.681125759954762*^9}, {3.6811258128895626`*^9, 3.6811258521850863`*^9}, {
   3.6811259105222607`*^9, 3.6811259151906843`*^9}, {3.6811260119380293`*^9, 
   3.681126015785262*^9}, {3.6811260762099886`*^9, 3.681126165698027*^9}, {
   3.6811266491038723`*^9, 3.681126734504032*^9}, {3.68112681709973*^9, 
   3.681126900026315*^9}, 3.681126939166427*^9, {3.68112730792333*^9, 
   3.681127489916432*^9}, {3.6811275283626666`*^9, 3.6811275504454374`*^9}, {
   3.6811275946199107`*^9, 3.681127603319048*^9}, {3.6811439907817297`*^9, 
   3.6811440008605804`*^9}, {3.6811758687572837`*^9, 3.681175895399081*^9}, {
   3.681175959885781*^9, 3.6811759687488174`*^9}, {3.6811760068465786`*^9, 
   3.6811760070688696`*^9}, {3.681176146958003*^9, 3.681176163137535*^9}, {
   3.681176233408076*^9, 3.6811762351032553`*^9}, {3.6811771632671595`*^9, 
   3.681177200898227*^9}, {3.6811772403922567`*^9, 3.6811772506736617`*^9}, {
   3.681177324364559*^9, 3.6811773423674145`*^9}, {3.6811774023173337`*^9, 
   3.681177402714535*^9}, {3.681177679615759*^9, 3.681177681413635*^9}, {
   3.6811777704815755`*^9, 3.6811777944864006`*^9}, {3.6811778325715456`*^9, 
   3.6811778549413524`*^9}, {3.6811778920336895`*^9, 
   3.6811780514007444`*^9}, {3.681178092113549*^9, 3.681178227526745*^9}, {
   3.681179366022626*^9, 3.681179396467493*^9}, {3.6811794543258667`*^9, 
   3.681179479608823*^9}, {3.681179786327493*^9, 3.681179804377884*^9}, {
   3.6812336644935875`*^9, 3.6812338253164883`*^9}, {3.68123386389913*^9, 
   3.681233880247927*^9}, {3.6812339142429748`*^9, 3.6812339147035913`*^9}, {
   3.6812340008027644`*^9, 3.681234007035535*^9}, {3.6812344390660954`*^9, 
   3.6812344597193737`*^9}, {3.6812345104639125`*^9, 
   3.6812345655827484`*^9}, {3.681235827328601*^9, 3.681235882717334*^9}, {
   3.681403467260279*^9, 3.6814035064429913`*^9}, {3.6815728614752245`*^9, 
   3.6815728622464004`*^9}, {3.6815729203858833`*^9, 3.681572921913185*^9}, {
   3.6822220003690753`*^9, 3.6822220010127306`*^9}, {3.6823557141057005`*^9, 
   3.68235575641883*^9}, {3.6823934640683956`*^9, 3.6823934744084206`*^9}, {
   3.6823935103235292`*^9, 3.682393558168972*^9}, {3.6823936399848547`*^9, 
   3.682393734308934*^9}, {3.682393788633649*^9, 3.682393831394211*^9}, 
   3.6833433163274918`*^9, {3.684750791044098*^9, 3.6847507912682385`*^9}}],

Cell[BoxData[
 FormBox["True", TraditionalForm]], "Output",
 CellChangeTimes->{
  3.681968086158311*^9, 3.6819828184820113`*^9, 3.6819859136454735`*^9, 
   3.682058003808815*^9, 3.6821321123125734`*^9, 3.682133144301004*^9, 
   3.682220727659088*^9, 3.6822220040920706`*^9, 3.6822463793143044`*^9, 
   3.68225508248224*^9, 3.6822984131792803`*^9, {3.6823557314389114`*^9, 
   3.6823557597180395`*^9}, {3.682356869086517*^9, 3.6823569140478015`*^9}, 
   3.6823569575924664`*^9, {3.6823569882753444`*^9, 3.6823570222972307`*^9}, 
   3.682390303103923*^9, {3.6823927986730366`*^9, 3.6823928216620684`*^9}, 
   3.682392994027842*^9, 3.682393037415866*^9, {3.682393122234582*^9, 
   3.68239317813803*^9}, {3.6823932232470274`*^9, 3.682393232126728*^9}, {
   3.682393295952295*^9, 3.682393322788718*^9}, 3.682393379516721*^9, {
   3.682393440357263*^9, 3.682393485242372*^9}, {3.682393516507995*^9, 
   3.682393562157669*^9}, 3.682393607163893*^9, {3.682393655141528*^9, 
   3.682393756243539*^9}, {3.6823937988112392`*^9, 3.682393834331253*^9}, 
   3.682394102834053*^9, {3.682394163718953*^9, 3.6823942124005804`*^9}, 
   3.682853346376487*^9, 3.682905340983471*^9, 3.683343342127174*^9, 
   3.6833451588032274`*^9, 3.6833715723383055`*^9, 3.683424905801162*^9, 
   3.6834260387906427`*^9, 3.68342615259499*^9, 3.684750665464523*^9, {
   3.684750798204634*^9, 3.6847508145469885`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"form", "=", 
    RowBox[{"FormPage", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<n\>\"", "\[Rule]", "\"\<Integer\>\""}], ",", 
        RowBox[{"\"\<word\>\"", "\[Rule]", 
         RowBox[{"Restricted", "[", 
          RowBox[{"\"\<String\>\"", ",", 
           RowBox[{"RegularExpression", "[", "\"\<[0-9]+\>\"", "]"}]}], 
          "]"}]}], ",", 
        RowBox[{"\"\<Direction\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<Forward\>\"", ",", "\"\<Backward\>\""}], "}"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"w", "=", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"Characters", "[", "#word", "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#Direction", "\[Equal]", "\"\<Forward\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Grid", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\"\<1) Increase the left digit     :\>\"", ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<.....\>\"", ",", "White"}], "]"}], " ", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"Row", "[", 
                   RowBox[{"f1", "[", "w", "]"}], "]"}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<2) Pad with zeroes on the left\\t :\>\"", ",", " ", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"Row", "[", 
                   RowBox[{"f2", "[", 
                    RowBox[{
                    RowBox[{"f1", "[", "w", "]"}], ",", "#n"}], "]"}], "]"}], 
                  "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<3) Apply x(yx)*\[RightArrow]yx :\>\"", ",", ",", "  ", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"Row", "[", 
                   RowBox[{"f3", "[", 
                    RowBox[{"f2", "[", 
                    RowBox[{
                    RowBox[{"f1", "[", "w", "]"}], ",", "#n"}], "]"}], "]"}], 
                   "]"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
             RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], " ", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Grid", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<1) Extend to lenght n leftwards by repetition    :\>\"", 
                 ",", 
                 RowBox[{"Style", "[", 
                  RowBox[{"\"\<.....\>\"", ",", "White"}], "]"}], " ", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"Row", "[", 
                   RowBox[{"b1", "[", 
                    RowBox[{"w", ",", "#n"}], "]"}], "]"}], "]"}]}], "}"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\"\<2) Remove leading zeros :\>\"", ",", " ", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"Row", "[", 
                   RowBox[{"b2", "[", 
                    RowBox[{"b1", "[", 
                    RowBox[{"w", ",", "#n"}], "]"}], "]"}], "]"}], "]"}]}], 
                "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<3) Decrease the left digit :\>\"", ",", ",", "  ", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"Row", "[", 
                   RowBox[{"b3", "[", 
                    RowBox[{"b2", "[", 
                    RowBox[{"b1", "[", 
                    RowBox[{"w", ",", "#n"}], "]"}], "]"}], "]"}], "]"}], 
                  "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
             RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "]"}], "&"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"CloudDeploy", "[", 
  RowBox[{
   RowBox[{"form", "[", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<n\>\"", "\[Rule]", "4"}], ",", 
      RowBox[{"\"\<word\>\"", "\[Rule]", "\"\<0101\>\""}]}], "|>"}], "]"}], 
   ",", "\"\<Next word generator\>\"", ",", 
   RowBox[{"Permissions", "\[Rule]", "\"\<Public\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6813171567854805`*^9, 3.681317164802116*^9}, {
   3.6813172828386784`*^9, 3.68131730089837*^9}, {3.6813188648247366`*^9, 
   3.681318870912368*^9}, {3.6813190428843374`*^9, 3.681319180856572*^9}, {
   3.6813195952449036`*^9, 3.6813196096997375`*^9}, {3.6813197624666543`*^9, 
   3.6813197760106177`*^9}, {3.6813198356609807`*^9, 
   3.6813199037256193`*^9}, {3.681319936576933*^9, 3.681319939268124*^9}, {
   3.6813222966042113`*^9, 3.6813223188453026`*^9}, {3.6813223510106735`*^9, 
   3.6813226457300844`*^9}, {3.6813226969678035`*^9, 
   3.6813227054204445`*^9}, {3.6813227390229177`*^9, 
   3.6813227748425736`*^9}, {3.6813228081050653`*^9, 
   3.6813228441626453`*^9}, {3.681323116057881*^9, 3.6813231243076262`*^9}, 
   3.681323164021723*^9, {3.681323250868307*^9, 3.6813233231286497`*^9}, 
   3.681323378420868*^9, 3.681323412316559*^9, {3.681323494518881*^9, 
   3.681323543442251*^9}, 3.681323620817113*^9, 3.681323694235553*^9, 
   3.681323739311928*^9, {3.681323769491352*^9, 3.681323994475787*^9}, 
   3.681324029219691*^9, {3.6813240596131096`*^9, 3.681324062201486*^9}, {
   3.6813241021041317`*^9, 3.681324110646672*^9}, {3.6813241438213463`*^9, 
   3.6813241701299925`*^9}, {3.681324251655831*^9, 3.6813242775755725`*^9}, {
   3.681324328876108*^9, 3.6813243462436047`*^9}, {3.681324425549033*^9, 
   3.681324428349084*^9}, 3.6813245050931115`*^9, {3.681324549092112*^9, 
   3.6813246985185432`*^9}, 3.681324729919908*^9, {3.6813247740972223`*^9, 
   3.681324778665601*^9}, {3.681324829015518*^9, 3.6813249054256926`*^9}, {
   3.68132495029368*^9, 3.6813249510383444`*^9}, {3.681324981345358*^9, 
   3.6813249899285946`*^9}, {3.681325497986582*^9, 3.681325533376735*^9}, {
   3.6813255640085773`*^9, 3.681325600360705*^9}, {3.681325649246523*^9, 
   3.6813256711439295`*^9}, {3.681325702563489*^9, 3.6813257544505296`*^9}, {
   3.681325807587268*^9, 3.681325866726122*^9}, {3.6813259204585466`*^9, 
   3.681325981130905*^9}, {3.6813260697915764`*^9, 3.681326090602209*^9}, {
   3.681326240580687*^9, 3.6813262968073273`*^9}, {3.681326330541162*^9, 
   3.6813268102856193`*^9}, {3.681326994434182*^9, 3.6813270361942186`*^9}, {
   3.68132708714425*^9, 3.6813270924505367`*^9}, {3.6813271498261046`*^9, 
   3.6813274754832773`*^9}, {3.681327507111298*^9, 3.681327611008257*^9}, 
   3.681400713705187*^9, {3.6814010386583705`*^9, 3.681401050404652*^9}, {
   3.681401137166792*^9, 3.6814011376728516`*^9}, {3.6814011730566945`*^9, 
   3.681401173771812*^9}, {3.6814014964428234`*^9, 3.6814016171155663`*^9}, {
   3.6814017734017553`*^9, 3.681401840759055*^9}, {3.681402183168148*^9, 
   3.681402188612306*^9}, {3.681625852086527*^9, 3.681625861972988*^9}, {
   3.6816259090917816`*^9, 3.6816259391564302`*^9}, {3.6816259953471518`*^9, 
   3.681625999313744*^9}, {3.6816260595711236`*^9, 3.681626371497976*^9}, {
   3.681626446504995*^9, 3.6816264477207894`*^9}, {3.6816264814968634`*^9, 
   3.6816265459910116`*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"CloudObject", "(", 
    TagBox[
     ButtonBox[
      PaneSelectorBox[{
       False->"\<\"https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-\
4abb-8e34-b382eec62148/Next word generator\"\>", True->
       StyleBox["\<\"https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-\
4abb-8e34-b382eec62148/Next word generator\"\>", "HyperlinkActive"]}, Dynamic[
        CurrentValue["MouseOver"]],
       BaseStyle->{"Hyperlink"},
       FrameMargins->0,
       ImageSize->Automatic],
      BaseStyle->"Hyperlink",
      ButtonData->{
        URL[
        "https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-4abb-8e34-\
b382eec62148/Next word generator"], None},
      ButtonNote->
       "https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-4abb-8e34-\
b382eec62148/Next word generator"],
     Annotation[#, 
      "https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-4abb-8e34-\
b382eec62148/Next word generator", "Hyperlink"]& ], ")"}],
   CloudObject[
   "https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-4abb-8e34-\
b382eec62148/Next word generator"],
   SelectWithContents->True], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.6819680878146257`*^9, 3.681982819640443*^9, 3.681985919408825*^9, 
   3.6820580089045725`*^9, 3.682132119275124*^9, 3.6821331453837123`*^9, 
   3.6822207361605935`*^9, 3.682246385296215*^9, 3.682255085897134*^9, 
   3.6822984146324606`*^9, {3.6823557464623156`*^9, 3.6823557606746035`*^9}, 
   3.682393615518016*^9, 3.6823937607185783`*^9, 3.6823941832261353`*^9, 
   3.6828533508926744`*^9, 3.682905345287341*^9, 3.6833433498511887`*^9, 
   3.6833435962802563`*^9, 3.6833440893957815`*^9, 3.683345162898291*^9, 
   3.683371577446618*^9, 3.683424914829431*^9, 3.683426043979961*^9, 
   3.683426157628443*^9, 3.6847506672456517`*^9, {3.6847507992452946`*^9, 
   3.684750815462571*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"w", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w", "=", 
     RowBox[{"RotateRight", "[", 
      RowBox[{"w", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rep", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "\[Rule]", 
         RowBox[{"Highlighted", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"seq", "[", "n", "]"}], "\[LeftDoubleBracket]", "#", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"FrameMargins", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], "]"}]}], ")"}], 
       "&"}], " ", "/@", " ", 
      RowBox[{"(", 
       RowBox[{"Range", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"SequencePosition", "[", 
           RowBox[{
            RowBox[{"seq", "[", "n", "]"}], ",", "w"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ")"}]}], 
       ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fseq", "=", 
     RowBox[{"ReplacePart", "[", 
      RowBox[{
       RowBox[{"seq", "[", "n", "]"}], ",", "rep"}], " ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Row", " ", "@", " ", 
    RowBox[{"Insert", "[", 
     RowBox[{"fseq", ",", "\"\<|\>\"", ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", "#", "}"}], "&"}], " ", "/@", " ", 
        RowBox[{"Most", "[", 
         RowBox[{"dev", "[", "n", "]"}], "]"}]}], "+", "1"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6814029257971225`*^9, 3.681402960631489*^9}, {
   3.681403048189619*^9, 3.6814030510603266`*^9}, {3.681403326026517*^9, 
   3.681403387323757*^9}, {3.6814035861542716`*^9, 3.6814036014894295`*^9}, {
   3.6814036326299515`*^9, 3.681403692955456*^9}, {3.681403835051219*^9, 
   3.681404137954033*^9}, {3.681404176726445*^9, 3.6814041779544764`*^9}, 
   3.6814042639815693`*^9, {3.681404319180153*^9, 3.6814043255385633`*^9}, {
   3.6814043799187784`*^9, 3.6814046325271287`*^9}, {3.681404717466545*^9, 
   3.6814047466981316`*^9}, {3.6814051470457644`*^9, 3.681405185042739*^9}, {
   3.681405265329268*^9, 3.6814052754150543`*^9}, {3.681405330392881*^9, 
   3.6814053666831627`*^9}, 3.681405401889221*^9, {3.6814054689741287`*^9, 
   3.681405493597322*^9}, {3.681405536686168*^9, 3.6814056103132534`*^9}, {
   3.6814056459145327`*^9, 3.6814057075719247`*^9}, {3.6814057417422905`*^9, 
   3.681405791583989*^9}, {3.681405831713357*^9, 3.6814058341356072`*^9}, {
   3.6814058646837015`*^9, 3.6814058671626225`*^9}, {3.6815720834856663`*^9, 
   3.681572093488958*^9}, {3.6815726991697607`*^9, 3.6815727001555915`*^9}, {
   3.681574090038418*^9, 3.681574117873005*^9}, {3.681575209093699*^9, 
   3.6815752288765726`*^9}, {3.681611673605094*^9, 3.6816116741474485`*^9}, {
   3.6816117517141404`*^9, 3.6816117533131876`*^9}, {3.681611812656968*^9, 
   3.6816118128320827`*^9}, {3.6816283520963497`*^9, 
   3.6816283555526066`*^9}, {3.6816430847286725`*^9, 
   3.6816431292864323`*^9}, {3.6817084842752295`*^9, 
   3.6817085982046547`*^9}, {3.681710296090865*^9, 3.681710298253182*^9}, {
   3.68171080337695*^9, 3.6817108061905465`*^9}, 3.6817108668387766`*^9, {
   3.681713710024721*^9, 3.6817137101341057`*^9}, {3.6817138448141665`*^9, 
   3.681713845470437*^9}, {3.6817149154854727`*^9, 3.6817149433734765`*^9}, {
   3.6817288689147973`*^9, 3.6817289063579416`*^9}, {3.6819681623815084`*^9, 
   3.6819682388096266`*^9}, {3.681985232139865*^9, 3.6819852517853827`*^9}, 
   3.6819853360779557`*^9, 3.6819857083936653`*^9, 3.682058051971602*^9, 
   3.682058111506566*^9, {3.68205814584326*^9, 3.6820581521404786`*^9}, 
   3.682066182490555*^9, {3.6820667516625233`*^9, 3.6820667531985273`*^9}, 
   3.682067229813007*^9, 3.6820682561587505`*^9, {3.6820691932611704`*^9, 
   3.6820692168115606`*^9}, {3.6820693814631653`*^9, 3.682069385702936*^9}, 
   3.682069733232055*^9, 3.682069767247285*^9, {3.6820703940449133`*^9, 
   3.682070396195318*^9}, {3.6820705093762856`*^9, 3.682070535759527*^9}, {
   3.682130730057235*^9, 3.6821307639443808`*^9}, 3.6821308307430353`*^9, {
   3.682131149057061*^9, 3.6821311492802076`*^9}, {3.682131196416012*^9, 
   3.682131214831047*^9}, {3.682131489673663*^9, 3.682131515080268*^9}, {
   3.6821318138745365`*^9, 3.6821318166113253`*^9}, 3.6821318538736773`*^9, {
   3.6821333013796597`*^9, 3.682133315891144*^9}, 3.6821333517135553`*^9, {
   3.6821334012649374`*^9, 3.682133405728855*^9}, 3.6821341443535643`*^9, {
   3.6822165661766434`*^9, 3.6822165740610948`*^9}, {3.6822172790817013`*^9, 
   3.6822172806755133`*^9}, {3.682218505957827*^9, 3.682218512951674*^9}, {
   3.682218926665144*^9, 3.6822189285714703`*^9}, 3.682219322560094*^9, {
   3.6822213550736437`*^9, 3.682221369951171*^9}, 3.6822236113913136`*^9, {
   3.682298410164405*^9, 3.6822984334636955`*^9}, 3.6833688212358656`*^9}],

Cell[BoxData[
 FormBox[
  TemplateBox[{
   "0","\"|\"",
    TemplateBox[{"0", FrameStyle -> None, FrameMargins -> {{-1, -1}, {0, 0}}},
      "Highlighted"],
    TemplateBox[{"0", FrameStyle -> None, FrameMargins -> {{-1, -1}, {0, 0}}},
      "Highlighted"],
    TemplateBox[{"0", FrameStyle -> None, FrameMargins -> {{-1, -1}, {0, 0}}},
      "Highlighted"],
    TemplateBox[{"1", FrameStyle -> None, FrameMargins -> {{-1, -1}, {0, 0}}},
      "Highlighted"],"\"|\"","0","1","\"|\"","0","0","1","1","\"|\"","0","1",
    "1","1","\"|\"","1","\"|\"","0","0","0","2","\"|\"","1","0","0","2",
    "\"|\"","0","1","0","2","\"|\"","1","1","0","2","\"|\"","0","2","\"|\"",
    "0","0","1","2","\"|\"","1","0","1","2","\"|\"","0","1","1","2","\"|\"",
    "1","1","1","2","\"|\"","0","2","1","2","\"|\"","1","2","\"|\"","0","0",
    "2","2","\"|\"","1","0","2","2","\"|\"","0","1","2","2","\"|\"","1","1",
    "2","2","\"|\"","0","2","2","2","\"|\"","1","2","2","2","\"|\"","2",
    "\"|\"","0","0","0","3","\"|\"","1","0","0","3","\"|\"","2","0","0","3",
    "\"|\"","0","1","0","3","\"|\"","1","1","0","3","\"|\"","2","1","0","3",
    "\"|\"","0","2","0","3","\"|\"","1","2","0","3","\"|\"","2","2","0","3",
    "\"|\"","0","3","\"|\"","0","0","1","3","\"|\"","1","0","1","3","\"|\"",
    "2","0","1","3","\"|\"","0","1","1","3","\"|\"","1","1","1","3","\"|\"",
    "2","1","1","3","\"|\"","0","2","1","3","\"|\"","1","2","1","3","\"|\"",
    "2","2","1","3","\"|\"","0","3","1","3","\"|\"","1","3","\"|\"","0","0",
    "2","3","\"|\"","1","0","2","3","\"|\"","2","0","2","3","\"|\"","0","1",
    "2","3","\"|\"","1","1","2","3","\"|\"","2","1","2","3","\"|\"","0","2",
    "2","3","\"|\"","1","2","2","3","\"|\"","2","2","2","3","\"|\"","0","3",
    "2","3","\"|\"","1","3","2","3","\"|\"","2","3","\"|\"","0","0","3","3",
    "\"|\"","1","0","3","3","\"|\"","2","0","3","3","\"|\"","0","1","3","3",
    "\"|\"","1","1","3","3","\"|\"","2","1","3","3","\"|\"","0","2","3","3",
    "\"|\"","1","2","3","3","\"|\"","2","2","3","3","\"|\"","0","3","3","3",
    "\"|\"","1","3","3","3","\"|\"","2","3","3","3","\"|\"","3"},
   "RowDefault"], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.6819680879240036`*^9, {3.681968164713747*^9, 3.6819682397002773`*^9}, 
   3.681982819719651*^9, {3.6819852381331835`*^9, 3.68198525252582*^9}, 
   3.681985336707367*^9, 3.681985710238879*^9, 3.6819859198679476`*^9, 
   3.6820580092673545`*^9, 3.6820580542996254`*^9, 3.6820581128351383`*^9, {
   3.6820581482602015`*^9, 3.6820581526248655`*^9}, 3.682066183708351*^9, 
   3.682066754050084*^9, 3.682067230376376*^9, 3.6820682566430655`*^9, {
   3.6820692022080183`*^9, 3.682069217505065*^9}, 3.6820693861062*^9, 
   3.68206970027852*^9, 3.6820697344678645`*^9, 3.6820697676045184`*^9, 
   3.682070396998843*^9, {3.6820705106761355`*^9, 3.682070536851242*^9}, 
   3.6821307337566586`*^9, 3.682130764253585*^9, 3.6821308312283525`*^9, 
   3.6821311496834707`*^9, {3.682131197730872*^9, 3.6821312156355724`*^9}, {
   3.6821314938203745`*^9, 3.6821315159158134`*^9}, {3.6821318470191984`*^9, 
   3.682131854475073*^9}, 3.682132119740428*^9, 3.682133145475774*^9, {
   3.6821333060417056`*^9, 3.682133316436499*^9}, 3.682133352207876*^9, {
   3.6821334019183636`*^9, 3.6821334062862186`*^9}, 3.682134145424264*^9, 
   3.682216575707436*^9, 3.682217281517067*^9, 3.6822185141532774`*^9, 
   3.682218929258992*^9, 3.682219323119342*^9, 3.682220736738739*^9, {
   3.682221363488285*^9, 3.68222137081689*^9}, 3.6822221928542194`*^9, {
   3.682223612283309*^9, 3.682223616008109*^9}, 3.682246386386927*^9, 
   3.6822464178374805`*^9, 3.6822465145987167`*^9, 3.6822550862292013`*^9, {
   3.6822984147262163`*^9, 3.682298434448101*^9}, {3.682355747048401*^9, 
   3.6823557607318144`*^9}, 3.6823568745814238`*^9, 3.6823936160148044`*^9, 
   3.682393761092345*^9, 3.682394185771537*^9, 3.6828533512051973`*^9, 
   3.6829053456779723`*^9, 3.6833433502232895`*^9, 3.6833451631953554`*^9, 
   3.6833688252428937`*^9, 3.683371577748708*^9, 3.6834249153514805`*^9, 
   3.683426044417471*^9, 3.6834261580503254`*^9, 3.6847506674557843`*^9, {
   3.6847507993493595`*^9, 3.6847508155656357`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pos", "[", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", "n_"}], "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pos", "[", 
    RowBox[{"w_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"pos", "[", "w", "]"}], "=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bw", "=", 
         RowBox[{"bb", "[", 
          RowBox[{"w", ",", "n"}], "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"pos", "[", "bw", "]"}], "+", 
        RowBox[{"Length", "[", "bw", "]"}]}]}], "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P4", "[", 
   RowBox[{"w_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"SequencePosition", "[", 
     RowBox[{
      RowBox[{"seq", "[", "n", "]"}], ",", 
      RowBox[{"Sow", "[", 
       RowBox[{"RotateRight", "[", 
        RowBox[{
         RowBox[{"b1", "[", 
          RowBox[{"w", ",", "n"}], "]"}], ",", "i"}], "]"}], "]"}]}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"pos", "[", 
     RowBox[{"w", ",", "n"}], "]"}], "-", "i", "-", "n", "+", 
    RowBox[{"Length", "[", "w", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P4", "[", "w_", "]"}], ":=", 
   RowBox[{"And", " ", "@@", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"P4", "[", 
       RowBox[{"w", ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{
         RowBox[{"Length", "[", "w", "]"}], "-", 
         RowBox[{"LengthWhile", "[", 
          RowBox[{"w", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "\[Equal]", " ", "0"}], ")"}], "&"}]}], "]"}], "-", 
         "1"}]}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inc", "[", 
    RowBox[{"w_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{"w", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"_", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"#", "<", "m"}], "&"}], ")"}]}], " ", "\[Rule]", "0"}], 
       ",", " ", 
       RowBox[{"m", "\[Rule]", 
        RowBox[{
         RowBox[{"w", "\[LeftDoubleBracket]", "m", "\[RightDoubleBracket]"}], 
         "+", "1"}]}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"advance", "[", 
    RowBox[{"w_", ",", "i_"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"SelectFirst", "[", " ", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"inc", "[", 
        RowBox[{"w", ",", "m"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "i", ",", "n"}], "}"}]}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"isLyndon", "[", "#", "]"}], " ", "\[And]", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"Most", "[", "#", "]"}], "]"}], "\[LessEqual]", "  ", 
         RowBox[{"Max", "[", "w", "]"}]}]}], ")"}], "&"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P5", "[", 
    RowBox[{"w_", ",", "i_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", "=", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"seq", "[", "n", "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"n", "-", "1"}]}], "]"}]}], "]"}], ",", "k"}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"SequencePosition", "[", 
         RowBox[{"s", ",", 
          RowBox[{"Sow", "[", 
           RowBox[{"RotateRight", "[", 
            RowBox[{
             RowBox[{"b1", "[", 
              RowBox[{"w", ",", "n"}], "]"}], ",", "i"}], "]"}], "]"}]}], 
         "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pos", "[", 
         RowBox[{
          RowBox[{"u", "=", 
           RowBox[{"advance", "[", 
            RowBox[{
             RowBox[{"b1", "[", 
              RowBox[{"w", ",", "n"}], "]"}], ",", 
             RowBox[{"n", "-", "i", "+", "1"}]}], "]"}]}], ",", "n"}], "]"}], 
        "-", "i", "+", 
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Length", "[", 
            RowBox[{"f3", "[", "u", "]"}], "]"}]}], ",", "n"}], "]"}]}]}], 
      ")"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P5", "[", "w_", "]"}], ":=", 
   RowBox[{"And", " ", "@@", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"P5", "[", 
       RowBox[{"w", ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"n", "-", 
         RowBox[{"LengthWhile", "[", 
          RowBox[{"w", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "\[Equal]", " ", "0"}], ")"}], "&"}]}], "]"}]}], 
        ",", 
        RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"R", "=", 
    RowBox[{
     RowBox[{"Reap", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"w", "=", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"lst", "[", "n", "]"}], ",", 
              RowBox[{
               RowBox[{"Not", "[", 
                RowBox[{"P4", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}], ")"}],
           "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"Print", "[", "\"\<P4 is true\>\"", "]"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<P4 is not true:\>\"", ",", "w"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"w", "=", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Rest", "[", 
               RowBox[{"lst", "[", "n", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"Not", "[", 
                RowBox[{"P5", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}], ")"}],
           "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"Print", "[", "\"\<P5 is true\>\"", "]"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<P5 is not true:\>\"", ",", "w"}], "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], "\[LeftDoubleBracket]", "2", 
     "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"all", "=", 
      RowBox[{"Rest", "[", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "2", ",", "3"}], "}"}], ",", "n"}], 
        "]"}], "]"}]}], ")"}], "\[Equal]", 
    RowBox[{"(", 
     RowBox[{"cov", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"R", ",", "1"}], "]"}], "]"}]}], ")"}]}], ",", " ", 
   RowBox[{"Print", "[", "\"\<All tuples are covered\>\"", "]"}], ",", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Not all tuples are covered:\>\"", "]"}], ";", 
    RowBox[{"Complement", "[", 
     RowBox[{"all", ",", "cov"}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.681709849440483*^9, {3.6817099042250504`*^9, 3.6817101536431456`*^9}, {
   3.6817101967206593`*^9, 3.681710268553749*^9}, {3.681710332217499*^9, 
   3.681710406718654*^9}, {3.681710443130435*^9, 3.681710477545294*^9}, {
   3.6817105100671325`*^9, 3.6817105446021004`*^9}, {3.6817106048673077`*^9, 
   3.681710681153737*^9}, {3.681710717171547*^9, 3.6817107926957254`*^9}, {
   3.681710836833011*^9, 3.681710846155605*^9}, {3.681714968746125*^9, 
   3.6817151301812944`*^9}, {3.6817158556350527`*^9, 
   3.6817159632483826`*^9}, {3.6817287531761856`*^9, 3.681728753982402*^9}, {
   3.6817287870818357`*^9, 3.681728820053199*^9}, {3.6817289401354523`*^9, 
   3.6817290865647497`*^9}, {3.6817291188388987`*^9, 
   3.6817291191826534`*^9}, {3.6817291588909893`*^9, 3.681729159222249*^9}, {
   3.6817292039912767`*^9, 3.6817292298147573`*^9}, {3.6817292771142917`*^9, 
   3.681729300657316*^9}, {3.681956479561783*^9, 3.6819565251386185`*^9}, {
   3.6819676617564974`*^9, 3.6819676686945543`*^9}, {3.6819677261109223`*^9, 
   3.6819677908121767`*^9}, {3.681968334099693*^9, 3.6819683845262322`*^9}, {
   3.681984981772131*^9, 3.6819849858626633`*^9}, {3.6819850912460785`*^9, 
   3.681985113401801*^9}, {3.6819852037343254`*^9, 3.681985213853896*^9}, 
   3.6819852589117746`*^9, {3.681985301715644*^9, 3.681985352599382*^9}, {
   3.681985384883479*^9, 3.6819853902203245`*^9}, {3.6819856522952385`*^9, 
   3.68198568379811*^9}, {3.681985727929855*^9, 3.681985745524706*^9}, {
   3.6819858580835457`*^9, 3.6819858876556177`*^9}, {3.681985933144781*^9, 
   3.681985989504673*^9}, {3.681986022649852*^9, 3.681986029414854*^9}, {
   3.6819861313880715`*^9, 3.681986147534997*^9}, {3.6819861861786933`*^9, 
   3.681986204671527*^9}, {3.682057746641906*^9, 3.6820577484674287`*^9}, {
   3.6820577849565353`*^9, 3.682057874755474*^9}, {3.6820579097302027`*^9, 
   3.6820579929348383`*^9}, {3.6820580328270955`*^9, 
   3.6820580340458913`*^9}, {3.682058073402169*^9, 3.6820580907928753`*^9}, 
   3.68205817072962*^9, {3.6820582247591453`*^9, 3.682058245125575*^9}, {
   3.6820654050064487`*^9, 3.682065483881996*^9}, {3.6820655183935504`*^9, 
   3.682065519593334*^9}, {3.682065550041233*^9, 3.682065584182545*^9}, {
   3.682065628055217*^9, 3.6820657533801203`*^9}, {3.6820657944519615`*^9, 
   3.6820661104274592`*^9}, {3.6820661435260897`*^9, 3.682066171610444*^9}, {
   3.6820662095302258`*^9, 3.6820662229219775`*^9}, {3.6820662605855913`*^9, 
   3.682066311769041*^9}, {3.6820663575919876`*^9, 3.6820664684214177`*^9}, {
   3.6820665130445805`*^9, 3.6820665247242126`*^9}, {3.682066575746557*^9, 
   3.682066632450615*^9}, {3.6820666849139013`*^9, 3.682066733038352*^9}, {
   3.6820667839506245`*^9, 3.682066805837928*^9}, {3.6820668800284147`*^9, 
   3.682066880220539*^9}, {3.6820669500591807`*^9, 3.682067032392988*^9}, {
   3.68206706965734*^9, 3.6820672039891305`*^9}, {3.6820672722287264`*^9, 
   3.682067281347686*^9}, {3.6820673115394163`*^9, 3.6820673344834113`*^9}, 
   3.68206736673849*^9, {3.682067399505906*^9, 3.6820674612002244`*^9}, {
   3.682067518879919*^9, 3.6820675561592827`*^9}, {3.6820675911331387`*^9, 
   3.682067662684899*^9}, 3.682067732251363*^9, {3.6820678178012724`*^9, 
   3.6820678293528214`*^9}, {3.6820680828674994`*^9, 
   3.6820681544973116`*^9}, {3.6820681874728622`*^9, 
   3.6820682228970118`*^9}, {3.682068334206756*^9, 3.682068334894206*^9}, {
   3.68206837327729*^9, 3.682068417388118*^9}, {3.6820684575793834`*^9, 
   3.6820685279613795`*^9}, {3.682068861299225*^9, 3.6820688638108664`*^9}, {
   3.682068960545084*^9, 3.6820690139039555`*^9}, {3.6820691120941257`*^9, 
   3.682069173036953*^9}, {3.6820692337076025`*^9, 3.6820692431627827`*^9}, 
   3.682069504469553*^9, {3.682069550020322*^9, 3.682069550788824*^9}, {
   3.682069612580206*^9, 3.682069636610911*^9}, {3.6820698278879156`*^9, 
   3.6820698583508234`*^9}, {3.682069914845744*^9, 3.6820699575326414`*^9}, {
   3.6820700597724576`*^9, 3.6820700602187505`*^9}, {3.6820701625045958`*^9, 
   3.682070214886829*^9}, {3.6820702600243273`*^9, 3.6820703081807995`*^9}, {
   3.6820703448687754`*^9, 3.682070345220005*^9}, {3.6820704279390635`*^9, 
   3.682070431186186*^9}, {3.682129855725836*^9, 3.68212991025047*^9}, {
   3.682129971674612*^9, 3.682130016889161*^9}, {3.682130050457099*^9, 
   3.682130054904005*^9}, {3.6821308889670863`*^9, 3.6821309446454735`*^9}, {
   3.6821309761020308`*^9, 3.682130987253318*^9}, {3.6821310251731005`*^9, 
   3.6821310785790024`*^9}, {3.682131233104989*^9, 3.682131234399835*^9}, 
   3.6821312747822266`*^9, {3.682131566424822*^9, 3.682131624377696*^9}, {
   3.682131763908883*^9, 3.682131782468013*^9}, {3.682131868483225*^9, 
   3.6821318710258865`*^9}, 3.682131915399886*^9, {3.6821319723531075`*^9, 
   3.682132014111397*^9}, {3.682132050128935*^9, 3.682132057869994*^9}, {
   3.682132240939635*^9, 3.6821322438975687`*^9}, 3.6821324235910034`*^9, {
   3.682132455494852*^9, 3.6821324830288467`*^9}, {3.682132541973369*^9, 
   3.68213260131515*^9}, {3.6821326463385735`*^9, 3.68213280932609*^9}, {
   3.6821328683816843`*^9, 3.68213289629993*^9}, {3.682133078505005*^9, 
   3.682133129974642*^9}, {3.682133183814828*^9, 3.6821331944067497`*^9}, {
   3.6821340853630133`*^9, 3.682134119395254*^9}, {3.6822168193463154`*^9, 
   3.6822171754956117`*^9}, {3.682217336168024*^9, 3.682217341933386*^9}, {
   3.6822173752510333`*^9, 3.6822173938262997`*^9}, {3.682217737123464*^9, 
   3.682217737482859*^9}, {3.682217797411558*^9, 3.6822177978334436`*^9}, {
   3.6822178716868486`*^9, 3.6822178719368515`*^9}, {3.6822179036035957`*^9, 
   3.6822179038379717`*^9}, {3.6822179587688284`*^9, 
   3.6822179704964743`*^9}, {3.6822180032274237`*^9, 
   3.6822180035399437`*^9}, {3.6822180570667*^9, 3.682218103697445*^9}, {
   3.682218140393379*^9, 3.6822181852808104`*^9}, {3.6822182847249403`*^9, 
   3.6822182916946173`*^9}, {3.6822183358887815`*^9, 
   3.6822183756920958`*^9}, {3.6822184125540085`*^9, 3.682218442767888*^9}, {
   3.6822187004867225`*^9, 3.682218737988488*^9}, {3.6822188502877345`*^9, 
   3.682218851022138*^9}, 3.6822192595255814`*^9, {3.682219576537396*^9, 
   3.682219576896783*^9}, {3.6822196343856454`*^9, 3.6822196346981497`*^9}, {
   3.68221979719042*^9, 3.682219798909239*^9}, 3.682219897572584*^9, {
   3.682220762824334*^9, 3.6822207851233997`*^9}, {3.6822208194155817`*^9, 
   3.6822208728563175`*^9}, {3.682221296017525*^9, 3.6822213223347163`*^9}, {
   3.6822550682825575`*^9, 3.682255115151046*^9}, {3.6822551823864965`*^9, 
   3.6822554348812237`*^9}, {3.682255517871771*^9, 3.682255715527017*^9}, {
   3.682255793243198*^9, 3.682255867875566*^9}, {3.682255942025832*^9, 
   3.6822559982604227`*^9}, {3.682256075716274*^9, 3.68225607939923*^9}, {
   3.682256193587881*^9, 3.682256196023514*^9}, {3.682256233118146*^9, 
   3.682256233413223*^9}, 3.68225643332817*^9, 3.682256484109356*^9, {
   3.682256593843851*^9, 3.6822566187522535`*^9}, {3.68225665309017*^9, 
   3.682256695614212*^9}, 3.6822996961565547`*^9, 3.6823005739904428`*^9, {
   3.6823006191186447`*^9, 3.6823006231399856`*^9}, {3.682301799917406*^9, 
   3.682301804386322*^9}, {3.6823020280848007`*^9, 3.6823021753742228`*^9}, {
   3.682302244412866*^9, 3.6823022495719423`*^9}, {3.6823022970492754`*^9, 
   3.682302349198652*^9}, 3.6823024018396454`*^9, {3.682320854762684*^9, 
   3.6823208760387154`*^9}, {3.6823209688902583`*^9, 3.682320973548374*^9}, 
   3.682355771860858*^9, {3.6823558676011295`*^9, 3.6823558853431892`*^9}, 
   3.68235789733703*^9, 3.682388700461483*^9, 3.682388922604168*^9, {
   3.682905392574813*^9, 3.682905409807389*^9}, {3.683349934503173*^9, 
   3.683349946621305*^9}, {3.6833712627445*^9, 3.6833712733032227`*^9}, 
   3.6833718263156977`*^9, {3.6834579843056884`*^9, 3.683458061310483*^9}, {
   3.683458173594632*^9, 3.683458269814602*^9}, {3.6847507727785234`*^9, 
   3.684750773013672*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox["\<\"P4 is true\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{
  3.6823889242378063`*^9, 3.6823936169658747`*^9, 3.6823937619232116`*^9, 
   3.682394186668589*^9, 3.6828533518302584`*^9, 3.682905346552987*^9, 
   3.683343350881461*^9, 3.683345163834521*^9, 3.6833715801003065`*^9, 
   3.6834249161760035`*^9, 3.6834260451362333`*^9, 3.683426158769089*^9, {
   3.683458019297861*^9, 3.6834580384490023`*^9}, 3.683458086513459*^9, {
   3.6834581874143887`*^9, 3.6834582709223037`*^9}, 3.6847506682292747`*^9, {
   3.684750745833449*^9, 3.6847508156176677`*^9}}],

Cell[BoxData[
 FormBox["\<\"P5 is true\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{
  3.6823889242378063`*^9, 3.6823936169658747`*^9, 3.6823937619232116`*^9, 
   3.682394186668589*^9, 3.6828533518302584`*^9, 3.682905346552987*^9, 
   3.683343350881461*^9, 3.683345163834521*^9, 3.6833715801003065`*^9, 
   3.6834249161760035`*^9, 3.6834260451362333`*^9, 3.683426158769089*^9, {
   3.683458019297861*^9, 3.6834580384490023`*^9}, 3.683458086513459*^9, {
   3.6834581874143887`*^9, 3.6834582709223037`*^9}, 3.6847506682292747`*^9, {
   3.684750745833449*^9, 3.684750815641683*^9}}],

Cell[BoxData[
 FormBox["\<\"Not all tuples are covered:\"\>", TraditionalForm]], "Print",
 CellChangeTimes->{
  3.6823889242378063`*^9, 3.6823936169658747`*^9, 3.6823937619232116`*^9, 
   3.682394186668589*^9, 3.6828533518302584`*^9, 3.682905346552987*^9, 
   3.683343350881461*^9, 3.683345163834521*^9, 3.6833715801003065`*^9, 
   3.6834249161760035`*^9, 3.6834260451362333`*^9, 3.683426158769089*^9, {
   3.683458019297861*^9, 3.6834580384490023`*^9}, 3.683458086513459*^9, {
   3.6834581874143887`*^9, 3.6834582709223037`*^9}, 3.6847506682292747`*^9, {
   3.684750745833449*^9, 3.6847508156436844`*^9}}]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "2", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.684750773453952*^9, 3.6847508156456857`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P5", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}], ",", "3"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.684750714202406*^9, 3.6847507580391827`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"0", "\[LongEqual]", 
   RowBox[{
    RowBox[{"pos", "(", 
     RowBox[{"Missing", "[", 
      RowBox[{"\<\"NotFound\"\>", ",", "\<\"NotFound\"\>", 
       ",", "\<\"NotFound\"\>", ",", "\<\"NotFound\"\>"}], "]"}], ")"}], "+", 
    "6"}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.6847507559778767`*^9, 3.6847508156566925`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"form", "=", 
    RowBox[{"FormPage", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<n\>\"", "\[Rule]", "\"\<Integer\>\""}], ",", 
        RowBox[{"\"\<word\>\"", "\[Rule]", 
         RowBox[{"Restricted", "[", 
          RowBox[{"\"\<String\>\"", ",", 
           RowBox[{"RegularExpression", "[", "\"\<[0-9]+\>\"", "]"}]}], 
          "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"w", "=", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"Characters", "[", "#word", "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"n", "=", "#n"}], ";", "\[IndentingNewLine]", 
          RowBox[{"rep", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"Highlighted", "[", 
                RowBox[{
                 RowBox[{"seq", "[", "n", "]"}], "\[LeftDoubleBracket]", "#", 
                 "\[RightDoubleBracket]"}], "]"}]}], ")"}], "&"}], " ", "/@", 
            " ", 
            RowBox[{"(", 
             RowBox[{"Range", "@@", 
              RowBox[{"(", 
               RowBox[{"p", "=", 
                RowBox[{
                 RowBox[{"SequencePosition", "[", 
                  RowBox[{
                   RowBox[{"seq", "[", "n", "]"}], ",", "w"}], "]"}], 
                 "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
               ")"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"fseq", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{
             RowBox[{"seq", "[", "n", "]"}], ",", "rep"}], " ", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Row", " ", "@", " ", 
           RowBox[{"Insert", "[", 
            RowBox[{"fseq", ",", "\"\<|\>\"", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", "#", "}"}], "&"}], " ", "/@", " ", 
               RowBox[{"Most", "[", 
                RowBox[{"dev", "[", "n", "]"}], "]"}]}], "+", "1"}]}], 
            "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "&"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"CloudDeploy", "[", 
  RowBox[{
   RowBox[{"form", "[", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<n\>\"", "\[Rule]", "4"}], ",", 
      RowBox[{"\"\<word\>\"", "\[Rule]", "\"\<0101\>\""}], ",", " ", 
      RowBox[{"\"\<Shift\>\"", "\[Rule]", "1"}]}], "|>"}], "]"}], ",", 
   "\"\<Highlighter\>\"", ",", 
   RowBox[{"Permissions", "\[Rule]", "\"\<Public\>\""}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6817183354017477`*^9, 3.68171868478507*^9}, {
   3.681718718504737*^9, 3.6817188363155785`*^9}, 3.681718895355111*^9, {
   3.6817189814801617`*^9, 3.681718984421155*^9}, 3.68171902168766*^9, 
   3.6817190598434353`*^9, 3.6817191136978197`*^9, {3.6817191468222237`*^9, 
   3.681719182663783*^9}, {3.6817192223309145`*^9, 3.681719255675904*^9}, {
   3.6817192900565305`*^9, 3.681719419382022*^9}, {3.681719465969874*^9, 
   3.6817194996321926`*^9}, {3.681719540327318*^9, 3.6817195407335835`*^9}, {
   3.6817195950618267`*^9, 3.6817197447650213`*^9}, {3.681719777423797*^9, 
   3.681719824854007*^9}, {3.6817198559500675`*^9, 3.6817198569958396`*^9}, {
   3.6817198906861973`*^9, 3.681719896104148*^9}, {3.681721011178234*^9, 
   3.681721126083798*^9}, {3.6817211813021326`*^9, 3.681721225404923*^9}, {
   3.681721256143613*^9, 3.6817213147364564`*^9}, {3.6817213588030376`*^9, 
   3.681721604144683*^9}, {3.6817216809443693`*^9, 3.681721710208126*^9}, {
   3.681721772531145*^9, 3.681721803425869*^9}, {3.681721855848197*^9, 
   3.681721859826895*^9}, {3.681721897518694*^9, 3.681721939155429*^9}, {
   3.68172198725016*^9, 3.6817220009066935`*^9}, {3.6823211217955265`*^9, 
   3.6823211363960657`*^9}, {3.6823211668494034`*^9, 3.682321167396297*^9}, {
   3.6823212254894505`*^9, 3.682321232530776*^9}, {3.6823212658482833`*^9, 
   3.6823213670692716`*^9}, {3.682321408715696*^9, 3.6823214586342235`*^9}, {
   3.6823230793736725`*^9, 3.6823231209080105`*^9}, {3.682323160636058*^9, 
   3.6823232346910253`*^9}, {3.682323288136777*^9, 3.6823233388229294`*^9}, {
   3.6823233696352315`*^9, 3.68232341041676*^9}, {3.683344023586512*^9, 
   3.683344042710661*^9}, {3.683344073783734*^9, 3.6833440762343698`*^9}, {
   3.6833441708497624`*^9, 3.683344171799018*^9}, 3.6833442053008204`*^9, {
   3.6833451476503344`*^9, 3.6833451482534885`*^9}}],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"CloudObject", "(", 
    TagBox[
     ButtonBox[
      PaneSelectorBox[{
       False->"\<\"https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-\
4abb-8e34-b382eec62148/Highlighter\"\>", True->
       StyleBox["\<\"https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-\
4abb-8e34-b382eec62148/Highlighter\"\>", "HyperlinkActive"]}, Dynamic[
        CurrentValue["MouseOver"]],
       BaseStyle->{"Hyperlink"},
       FrameMargins->0,
       ImageSize->Automatic],
      BaseStyle->"Hyperlink",
      ButtonData->{
        URL[
        "https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-4abb-8e34-\
b382eec62148/Highlighter"], None},
      ButtonNote->
       "https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-4abb-8e34-\
b382eec62148/Highlighter"],
     Annotation[#, 
      "https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-4abb-8e34-\
b382eec62148/Highlighter", "Hyperlink"]& ], ")"}],
   CloudObject[
   "https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-4abb-8e34-\
b382eec62148/Highlighter"],
   SelectWithContents->True], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.6819565279803476`*^9, 3.681968089111559*^9, 3.68198282092093*^9, 
   3.681985921185869*^9, 3.682058010501786*^9, 3.68213212119438*^9, 
   3.6821331467325935`*^9, 3.682220738160678*^9, 3.682246389049668*^9, 
   3.6822550885528154`*^9, 3.6822984161325197`*^9, {3.682321143046237*^9, 
   3.682321169662004*^9}, 3.682321239329053*^9, 3.6823213714773016`*^9, {
   3.6823214163484755`*^9, 3.6823214615803366`*^9}, 3.682323345237792*^9, 
   3.6823233858423915`*^9, {3.6823557484151793`*^9, 3.682355761951826*^9}, 
   3.6823936187325664`*^9, 3.6823937636486874`*^9, 3.682394188523182*^9, 
   3.6828533553436594`*^9, 3.6829053482274237`*^9, 3.6833433525258718`*^9, {
   3.6833440815107384`*^9, 3.6833440972037973`*^9}, 3.6833441744607115`*^9, 
   3.6833442071833096`*^9, 3.6833451654479513`*^9, 3.6833715817877445`*^9, 
   3.683424917893091*^9, 3.6834260467609997`*^9, 3.6834261603941174`*^9, 
   3.6847506707478714`*^9, 3.6847508036320744`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"comp", "[", 
   RowBox[{"l1_", ",", "l2_"}], "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{"l1", ",", 
    RowBox[{
     RowBox[{"Not", "[", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"l2", ",", "#"}], "]"}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyc", "[", 
   RowBox[{"n_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"comp", "[", 
   RowBox[{
    RowBox[{"Subsequences", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"seq", "[", "n", "]"}], ",", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"seq", "[", "n", "]"}], ",", 
          RowBox[{"n", "-", "1"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "n", "}"}]}], "]"}], ",", 
    RowBox[{"Union", " ", "@@", 
     RowBox[{"(", " ", 
      RowBox[{"rotations", " ", "/@", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"b1", "[", 
           RowBox[{"#", ",", "n"}], "]"}], "&"}], " ", "/@", " ", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"lst", "[", "n", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"k", "+", "1"}], ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ")"}]}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hcyc", "[", 
    RowBox[{"n_", ",", "k_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Row", " ", "/@", " ", 
      RowBox[{"cyc", "[", 
       RowBox[{"n", ",", "k"}], "]"}]}], ")"}], "/.", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Row", "[", "#", "]"}], "\[Rule]", 
         RowBox[{"Highlighted", "[", 
          RowBox[{"Row", "[", "#", "]"}], "]"}]}], ")"}], "&"}], " ", "/@", 
      " ", 
      RowBox[{"rotations", "[", 
       RowBox[{"b1", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"lst", "[", "n", "]"}], "\[LeftDoubleBracket]", "k", 
          "\[RightDoubleBracket]"}], ",", "n"}], "]"}], "]"}]}], ")"}]}]}], 
  " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"isShifts", "[", "l_", "]"}], ":=", 
  RowBox[{"And", " ", "@@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"l", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"RotateRight", "[", 
          RowBox[{"l", "\[LeftDoubleBracket]", 
           RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "]"}], ",", 
         RowBox[{"1", "\[Rule]", " ", "_"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Length", "[", "l", "]"}], "-", "1"}]}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"And", " ", "@@", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"isShifts", "[", 
      RowBox[{"cyc", "[", 
       RowBox[{"4", ",", "i"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "24"}], "}"}]}], "]"}]}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Column", "[", 
     RowBox[{"hcyc", "[", 
      RowBox[{"4", ",", "i"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "7"}], "}"}]}], "]"}], "  "}]}], "Input",
 CellChangeTimes->{{3.681896949842039*^9, 3.681897042321001*^9}, {
   3.681897087674243*^9, 3.6818972673721523`*^9}, {3.681897361358302*^9, 
   3.6818974281878705`*^9}, {3.681897489365201*^9, 3.6818977931754036`*^9}, {
   3.6818978516771464`*^9, 3.6818978778678937`*^9}, {3.681897926178877*^9, 
   3.6818979543161163`*^9}, {3.6818980979626255`*^9, 
   3.6818981035791364`*^9}, {3.6819014347678795`*^9, 3.681901473965417*^9}, {
   3.68190187825021*^9, 3.6819019473895283`*^9}, {3.6819020210228586`*^9, 
   3.6819020304611735`*^9}, {3.681902089716555*^9, 3.6819020923615036`*^9}, {
   3.6819021721357875`*^9, 3.6819021846943893`*^9}, {3.6819022369060497`*^9, 
   3.68190224230859*^9}, 3.6819023101905746`*^9, {3.6819563931960545`*^9, 
   3.6819564513985925`*^9}, {3.681956551278912*^9, 3.6819565961104174`*^9}, {
   3.681956807286838*^9, 3.681956810723878*^9}, {3.6819568409764233`*^9, 
   3.6819568415045652`*^9}, {3.681956904241473*^9, 3.6819569496461773`*^9}, {
   3.68195702007076*^9, 3.6819571520675287`*^9}, {3.681957187157877*^9, 
   3.68195723541059*^9}, {3.681957288488269*^9, 3.681957401624517*^9}, {
   3.6819608915846853`*^9, 3.681960906351548*^9}, {3.681963742420019*^9, 
   3.681963764434952*^9}, {3.681963834615143*^9, 3.681963867764886*^9}, 
   3.6834258204282274`*^9, 3.6834266336459312`*^9}],

Cell[BoxData[
 FormBox["True", TraditionalForm]], "Output",
 CellChangeTimes->{{3.6818978524427176`*^9, 3.681897878377271*^9}, 
   3.681897957032936*^9, 3.681898106667173*^9, {3.6819014621581383`*^9, 
   3.6819014748848853`*^9}, {3.6819019197580376`*^9, 3.681901948151987*^9}, {
   3.6819020264325633`*^9, 3.681902031020113*^9}, 3.681902093184445*^9, 
   3.6819021877771683`*^9, {3.681902244675437*^9, 3.681902244815439*^9}, {
   3.681956400499791*^9, 3.681956452195899*^9}, 3.681956539975978*^9, {
   3.6819565879826126`*^9, 3.681956596856775*^9}, 3.6819568118496656`*^9, 
   3.681956842426463*^9, {3.6819569159810305`*^9, 3.6819569501754665`*^9}, {
   3.681957204845233*^9, 3.6819572358481035`*^9}, {3.6819572935631933`*^9, 
   3.6819573248128967`*^9}, {3.6819573657031627`*^9, 3.6819574019997044`*^9}, 
   3.68196090715612*^9, {3.681963743744058*^9, 3.681963765265771*^9}, {
   3.6819638494430714`*^9, 3.6819638684168863`*^9}, 3.6823560612119913`*^9, 
   3.682561004341186*^9, 3.6834257510350447`*^9, 3.683425821084491*^9, 
   3.6834260470515275`*^9, 3.683426160673758*^9, 3.6834266345822144`*^9, 
   3.684750671077079*^9, 3.6847508039732895`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    TagBox[GridBox[{
       {
        TemplateBox[{
         TemplateBox[{"0", "0", "0", "0"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]}
      },
      DefaultBaseStyle->"Column",
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     "Column"], ",", 
    TagBox[GridBox[{
       {
        TemplateBox[{"0","0","0","0"},
         "RowDefault"]},
       {
        TemplateBox[{
         TemplateBox[{"0", "0", "0", "1"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{
         TemplateBox[{"0", "0", "1", "0"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{
         TemplateBox[{"0", "1", "0", "0"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{
         TemplateBox[{"1", "0", "0", "0"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]}
      },
      DefaultBaseStyle->"Column",
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     "Column"], ",", 
    TagBox[GridBox[{
       {
        TemplateBox[{"0","0","0","0"},
         "RowDefault"]},
       {
        TemplateBox[{"0","0","0","1"},
         "RowDefault"]},
       {
        TemplateBox[{"0","0","1","0"},
         "RowDefault"]},
       {
        TemplateBox[{
         TemplateBox[{"0", "1", "0", "1"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{
         TemplateBox[{"1", "0", "1", "0"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{"0","1","0","0"},
         "RowDefault"]},
       {
        TemplateBox[{"1","0","0","0"},
         "RowDefault"]}
      },
      DefaultBaseStyle->"Column",
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     "Column"], ",", 
    TagBox[GridBox[{
       {
        TemplateBox[{"0","0","0","0"},
         "RowDefault"]},
       {
        TemplateBox[{"0","0","0","1"},
         "RowDefault"]},
       {
        TemplateBox[{"0","0","1","0"},
         "RowDefault"]},
       {
        TemplateBox[{"0","1","0","1"},
         "RowDefault"]},
       {
        TemplateBox[{"1","0","1","0"},
         "RowDefault"]},
       {
        TemplateBox[{"0","1","0","0"},
         "RowDefault"]},
       {
        TemplateBox[{
         TemplateBox[{"1", "0", "0", "1"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{
         TemplateBox[{"0", "0", "1", "1"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{
         TemplateBox[{"0", "1", "1", "0"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{
         TemplateBox[{"1", "1", "0", "0"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{"1","0","0","0"},
         "RowDefault"]}
      },
      DefaultBaseStyle->"Column",
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     "Column"], ",", 
    TagBox[GridBox[{
       {
        TemplateBox[{"0","0","0","0"},
         "RowDefault"]},
       {
        TemplateBox[{"0","0","0","1"},
         "RowDefault"]},
       {
        TemplateBox[{"0","0","1","0"},
         "RowDefault"]},
       {
        TemplateBox[{"0","1","0","1"},
         "RowDefault"]},
       {
        TemplateBox[{"1","0","1","0"},
         "RowDefault"]},
       {
        TemplateBox[{"0","1","0","0"},
         "RowDefault"]},
       {
        TemplateBox[{"1","0","0","1"},
         "RowDefault"]},
       {
        TemplateBox[{"0","0","1","1"},
         "RowDefault"]},
       {
        TemplateBox[{"0","1","1","0"},
         "RowDefault"]},
       {
        TemplateBox[{
         TemplateBox[{"1", "1", "0", "1"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{
         TemplateBox[{"1", "0", "1", "1"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{
         TemplateBox[{"0", "1", "1", "1"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{
         TemplateBox[{"1", "1", "1", "0"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{"1","1","0","0"},
         "RowDefault"]},
       {
        TemplateBox[{"1","0","0","0"},
         "RowDefault"]}
      },
      DefaultBaseStyle->"Column",
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     "Column"], ",", 
    TagBox[GridBox[{
       {
        TemplateBox[{"0","0","0","0"},
         "RowDefault"]},
       {
        TemplateBox[{"0","0","0","1"},
         "RowDefault"]},
       {
        TemplateBox[{"0","0","1","0"},
         "RowDefault"]},
       {
        TemplateBox[{"0","1","0","1"},
         "RowDefault"]},
       {
        TemplateBox[{"1","0","1","0"},
         "RowDefault"]},
       {
        TemplateBox[{"0","1","0","0"},
         "RowDefault"]},
       {
        TemplateBox[{"1","0","0","1"},
         "RowDefault"]},
       {
        TemplateBox[{"0","0","1","1"},
         "RowDefault"]},
       {
        TemplateBox[{"0","1","1","0"},
         "RowDefault"]},
       {
        TemplateBox[{"1","1","0","1"},
         "RowDefault"]},
       {
        TemplateBox[{"1","0","1","1"},
         "RowDefault"]},
       {
        TemplateBox[{"0","1","1","1"},
         "RowDefault"]},
       {
        TemplateBox[{
         TemplateBox[{"1", "1", "1", "1"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{"1","1","1","0"},
         "RowDefault"]},
       {
        TemplateBox[{"1","1","0","0"},
         "RowDefault"]},
       {
        TemplateBox[{"1","0","0","0"},
         "RowDefault"]}
      },
      DefaultBaseStyle->"Column",
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     "Column"], ",", 
    TagBox[GridBox[{
       {
        TemplateBox[{"0","0","0","0"},
         "RowDefault"]},
       {
        TemplateBox[{"0","0","0","1"},
         "RowDefault"]},
       {
        TemplateBox[{"0","0","1","0"},
         "RowDefault"]},
       {
        TemplateBox[{"0","1","0","1"},
         "RowDefault"]},
       {
        TemplateBox[{"1","0","1","0"},
         "RowDefault"]},
       {
        TemplateBox[{"0","1","0","0"},
         "RowDefault"]},
       {
        TemplateBox[{"1","0","0","1"},
         "RowDefault"]},
       {
        TemplateBox[{"0","0","1","1"},
         "RowDefault"]},
       {
        TemplateBox[{"0","1","1","0"},
         "RowDefault"]},
       {
        TemplateBox[{"1","1","0","1"},
         "RowDefault"]},
       {
        TemplateBox[{"1","0","1","1"},
         "RowDefault"]},
       {
        TemplateBox[{"0","1","1","1"},
         "RowDefault"]},
       {
        TemplateBox[{"1","1","1","1"},
         "RowDefault"]},
       {
        TemplateBox[{"1","1","1","0"},
         "RowDefault"]},
       {
        TemplateBox[{"1","1","0","0"},
         "RowDefault"]},
       {
        TemplateBox[{"1","0","0","0"},
         "RowDefault"]},
       {
        TemplateBox[{
         TemplateBox[{"0", "0", "0", "2"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{
         TemplateBox[{"0", "0", "2", "0"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{
         TemplateBox[{"0", "2", "0", "0"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]},
       {
        TemplateBox[{
         TemplateBox[{"2", "0", "0", "0"}, "RowDefault"],FrameStyle -> None},
         "Highlighted"]}
      },
      DefaultBaseStyle->"Column",
      GridBoxAlignment->{"Columns" -> {{Left}}},
      GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
     "Column"]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.6818978524427176`*^9, 3.681897878377271*^9}, 
   3.681897957032936*^9, 3.681898106667173*^9, {3.6819014621581383`*^9, 
   3.6819014748848853`*^9}, {3.6819019197580376`*^9, 3.681901948151987*^9}, {
   3.6819020264325633`*^9, 3.681902031020113*^9}, 3.681902093184445*^9, 
   3.6819021877771683`*^9, {3.681902244675437*^9, 3.681902244815439*^9}, {
   3.681956400499791*^9, 3.681956452195899*^9}, 3.681956539975978*^9, {
   3.6819565879826126`*^9, 3.681956596856775*^9}, 3.6819568118496656`*^9, 
   3.681956842426463*^9, {3.6819569159810305`*^9, 3.6819569501754665`*^9}, {
   3.681957204845233*^9, 3.6819572358481035`*^9}, {3.6819572935631933`*^9, 
   3.6819573248128967`*^9}, {3.6819573657031627`*^9, 3.6819574019997044`*^9}, 
   3.68196090715612*^9, {3.681963743744058*^9, 3.681963765265771*^9}, {
   3.6819638494430714`*^9, 3.6819638684168863`*^9}, 3.6823560612119913`*^9, 
   3.682561004341186*^9, 3.6834257510350447`*^9, 3.683425821084491*^9, 
   3.6834260470515275`*^9, 3.683426160673758*^9, 3.6834266345822144`*^9, 
   3.684750671077079*^9, 3.6847508040873613`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6818976839935827`*^9, 3.6818976880956736`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6818976518328495`*^9, 3.6818976532215652`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"anchor", "[", 
    RowBox[{"w_", ",", "n_", ",", "l_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Take", "[", 
      RowBox[{
       RowBox[{"RotateLeft", "[", 
        RowBox[{
         RowBox[{"b1", "[", 
          RowBox[{
           RowBox[{"bb", "[", 
            RowBox[{"w", ",", "n"}], "]"}], ",", "n"}], "]"}], ",", "l"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"n", "-", "l"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", "l"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addCycle", "[", 
    RowBox[{"c1_", ",", "w_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", "=", 
       RowBox[{"LengthWhile", "[", 
        RowBox[{"w", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "\[Equal]", "0"}], ")"}], "&"}]}], "]"}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"c1", ",", 
            RowBox[{"anchor", "[", 
             RowBox[{"w", ",", "n", ",", "l"}], "]"}]}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "+", "1"}], " ",
         ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Take", "[", 
         RowBox[{"c1", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"p", "-", "1"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RotateLeft", "[", 
         RowBox[{
          RowBox[{"rotations", "[", 
           RowBox[{"b1", "[", 
            RowBox[{"w", ",", "n"}], "]"}], "]"}], ",", 
          RowBox[{"l", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Take", "[", 
         RowBox[{"c1", ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "4"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"words", "=", 
    RowBox[{"NestList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ff", "[", 
        RowBox[{"#", ",", "n"}], "]"}], "&"}], ",", 
      RowBox[{"{", "0", "}"}], ",", "100"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sss", "[", "i_", "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"Join", "@@", " ", 
     RowBox[{"Take", "[", 
      RowBox[{"words", ",", "i"}], "]"}]}], ",", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"n", "-", "1"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expected", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Subsequences", "[", 
      RowBox[{
       RowBox[{"sss", "[", "i", "]"}], ",", 
       RowBox[{"{", "n", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "words", "]"}]}], "}"}]}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mine", "=", 
   RowBox[{"FoldList", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"addCycle", "[", 
       RowBox[{"#1", ",", "#2", ",", "n"}], "]"}], "&"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "n"}], "]"}], "}"}], ",", 
     RowBox[{"Rest", "[", "words", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"mine", "==", "expected"}]}], "Input",
 CellChangeTimes->{{3.6819580545628333`*^9, 3.6819581050780635`*^9}, {
   3.6819600747980785`*^9, 3.6819602384810004`*^9}, {3.68196083556822*^9, 
   3.681960836464243*^9}, {3.6819610329564767`*^9, 3.6819612627717223`*^9}, {
   3.6819612986526732`*^9, 3.6819613278628445`*^9}, {3.6819613753654127`*^9, 
   3.681961378871522*^9}, {3.681961411201623*^9, 3.6819615632159615`*^9}, {
   3.6819616089852133`*^9, 3.681961622064294*^9}, {3.681961652768033*^9, 
   3.6819616571683235`*^9}, {3.6819617004678993`*^9, 3.681961732167627*^9}, {
   3.681962424908568*^9, 3.6819626650663505`*^9}, {3.6819626953381023`*^9, 
   3.681962781124299*^9}, {3.68196291968867*^9, 3.6819637199505067`*^9}, {
   3.681963905630136*^9, 3.681963935840328*^9}, {3.6819639972949796`*^9, 
   3.6819640267478304`*^9}, {3.6819816367320147`*^9, 
   3.6819816452999983`*^9}, {3.681981690556566*^9, 3.6819817821894464`*^9}, {
   3.681981814681383*^9, 3.681981838266337*^9}, {3.6819820546145067`*^9, 
   3.6819820808182735`*^9}, {3.681982129969037*^9, 3.6819821466769495`*^9}, {
   3.6819821916137247`*^9, 3.6819821938677797`*^9}, {3.681982239810413*^9, 
   3.6819823191574116`*^9}, {3.681982357785205*^9, 3.681982576206992*^9}, {
   3.6819826100524535`*^9, 3.681982624729081*^9}, 3.6819827021456785`*^9, {
   3.6819833883772335`*^9, 3.681983398870566*^9}, {3.6819834553478003`*^9, 
   3.681983478107296*^9}, {3.6819835265279675`*^9, 3.681983595394701*^9}, {
   3.681984492296756*^9, 3.6819846417077937`*^9}, {3.682356093913757*^9, 
   3.682356094924752*^9}, {3.6825610591282015`*^9, 3.682561069030342*^9}, {
   3.6825611158863535`*^9, 3.68256111641763*^9}, {3.682563064612297*^9, 
   3.6825631158548727`*^9}, {3.6834259784478045`*^9, 3.6834259788696833`*^9}, 
   3.6834260135585403`*^9, {3.6834260787482805`*^9, 3.6834260889166718`*^9}, 
   3.683426144516718*^9, {3.6847508095388165`*^9, 3.6847508100341296`*^9}}],

Cell[BoxData[
 FormBox["True", TraditionalForm]], "Output",
 CellChangeTimes->{{3.681963121432418*^9, 3.6819631398867326`*^9}, {
   3.6819631729539213`*^9, 3.6819631794509525`*^9}, {3.681963214670445*^9, 
   3.6819632288415375`*^9}, {3.681963390384647*^9, 3.681963454567525*^9}, {
   3.6819634934685*^9, 3.6819635513676424`*^9}, 3.6819635890913363`*^9, {
   3.6819636318270206`*^9, 3.6819636598823223`*^9}, {3.6819636947667875`*^9, 
   3.6819637205142736`*^9}, 3.6819638789804335`*^9, {3.6819639234235306`*^9, 
   3.6819639383443165`*^9}, {3.681964016979175*^9, 3.681964023937602*^9}, 
   3.6819677513778334`*^9, {3.6819816387560773`*^9, 3.6819816461085835`*^9}, 
   3.681981687350093*^9, 3.6819817779457417`*^9, {3.6819818182934313`*^9, 
   3.6819818330973673`*^9}, 3.6819819585523686`*^9, 3.681982070901012*^9, 
   3.681982152231718*^9, {3.681982293274847*^9, 3.681982319754147*^9}, {
   3.6819823689413424`*^9, 3.6819823776755495`*^9}, {3.6819824792395935`*^9, 
   3.6819825295709295`*^9}, {3.681982569409927*^9, 3.6819826324822364`*^9}, 
   3.6819827025929403`*^9, 3.6819828404321327`*^9, 3.681982997553203*^9, 
   3.681983101883848*^9, 3.681983194920382*^9, 3.681983309787614*^9, {
   3.6819833894916825`*^9, 3.6819834021221523`*^9}, 3.681983468328061*^9, 
   3.6819834986292667`*^9, 3.6819835659706235`*^9, 3.681983602093402*^9, 
   3.6819844936717987`*^9, {3.6819845386021404`*^9, 3.68198465311582*^9}, 
   3.68235606994754*^9, 3.682356103604563*^9, 3.6825610135915422`*^9, 
   3.68256112686994*^9, {3.6825630921093545`*^9, 3.68256310957677*^9}, 
   3.6834257603162017`*^9, 3.6834260578639903`*^9, 3.6834261608925133`*^9, 
   3.684750671373267*^9, 3.6847508042704782`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.681983409583898*^9, 3.6819834499893265`*^9}, {
  3.681983506116105*^9, 3.6819835086295652`*^9}, {3.681983578818533*^9, 
  3.681983579586173*^9}, {3.68198449795322*^9, 3.6819845329804783`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hcyc", "[", 
    RowBox[{"n_", ",", "k_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ToString", " ", "[", "#", "]"}], "<>", "\"\<,\>\""}], "&"}], 
      "/@", " ", 
      RowBox[{"Row", "/@", " ", 
       RowBox[{"cyc", "[", 
        RowBox[{"n", ",", "k"}], "]"}]}]}], ")"}], "/.", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"Row", "[", "#", "]"}], "]"}], "<>", "\"\<,\>\""}], 
         "\[Rule]", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ToString", "[", 
             RowBox[{"Row", "[", "#", "]"}], "]"}], "<>", "\"\<,\>\""}], ",", 
           "Blue"}], "]"}]}], ")"}], "&"}], " ", "/@", " ", 
      RowBox[{"rotations", "[", 
       RowBox[{"b1", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"lst", "[", "n", "]"}], "\[LeftDoubleBracket]", "k", 
          "\[RightDoubleBracket]"}], ",", "n"}], "]"}], "]"}]}], ")"}]}]}], 
  " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"form", "=", 
    RowBox[{"FormPage", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<n\>\"", "\[Rule]", "\"\<Integer\>\""}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<k\>\"", ",", "\"\<Cycle index\>\""}], "}"}], 
         "\[Rule]", "\"\<Integer\>\""}]}], "}"}], ",", "\[IndentingNewLine]", 
      " ", 
      RowBox[{
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"hcyc", "[", 
            RowBox[{"#n", ",", "i"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "#k"}], "}"}]}], "]"}], ",", 
         RowBox[{"Dividers", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}]}], "]"}], "&"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"CloudDeploy", "[", 
  RowBox[{
   RowBox[{"form", "[", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<n\>\"", "\[Rule]", "4"}], ",", 
      RowBox[{"\"\<k\>\"", "\[Rule]", "5"}]}], "|>"}], "]"}], ",", 
   "\"\<Cycle join\>\"", ",", 
   RowBox[{"Permissions", "\[Rule]", "\"\<Public\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQ/a9iX9j7/NeOx+4figDR0wTVjk8ufO0ofG7aRRD9
9OvCryB6xTtlzilA+sqrJn4QPa/tlxCI3m1vJAGi1yz+LAuiQ54bqYBoMZ75
qiBaQIbpJIg+8MjsFIjusS26CKLrLjlcAdG7qh1vgWjm0vVg+kaz2hMQfent
/Ocgus1g13sQveMOm+RUIF20zcMbRPPOiQ4C0c8ynk6fDaT/z3dYBKKLFrB8
BdHq34oZ5gDpFsPbLCCaTeWBAIiuenBWDERv2lYvDqJnSHjKgOiFEkFgesfP
aGUQrSI23wBMn+M3BdEv5PbagGgdiUp/EP3l2O5AEJ2RNTUeRLOwu1SD6La+
pEYQLVBdCqYBQ1635w==
  "]],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"CloudObject", "(", 
    TagBox[
     ButtonBox[
      PaneSelectorBox[{
       False->"\<\"https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-\
4abb-8e34-b382eec62148/Cycle join\"\>", True->
       StyleBox["\<\"https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-\
4abb-8e34-b382eec62148/Cycle join\"\>", "HyperlinkActive"]}, Dynamic[
        CurrentValue["MouseOver"]],
       BaseStyle->{"Hyperlink"},
       FrameMargins->0,
       ImageSize->Automatic],
      BaseStyle->"Hyperlink",
      ButtonData->{
        URL[
        "https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-4abb-8e34-\
b382eec62148/Cycle join"], None},
      ButtonNote->
       "https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-4abb-8e34-\
b382eec62148/Cycle join"],
     Annotation[#, 
      "https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-4abb-8e34-\
b382eec62148/Cycle join", "Hyperlink"]& ], ")"}],
   CloudObject[
   "https://www.wolframcloud.com/objects/user-8ab1f53b-d5b2-4abb-8e34-\
b382eec62148/Cycle join"],
   SelectWithContents->True], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.6834433463260803`*^9, {3.683443456822055*^9, 3.6834434678084717`*^9}, 
   3.6834435228765917`*^9, 3.683443556147045*^9, 3.683443588693696*^9, 
   3.683443625020012*^9, 3.683443680226241*^9, 3.683443725470413*^9, 
   3.6847506736006794`*^9, 3.6847508064768763`*^9}]
}, Open  ]]
},
WindowSize->{1680, 967},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.4 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 6447, 185, 632, "Input"],
Cell[7030, 209, 933, 14, 41, "Output"]
}, Open  ]],
Cell[7978, 226, 7657, 186, 632, "Input"],
Cell[CellGroupData[{
Cell[15660, 416, 4736, 96, 354, "Input"],
Cell[20399, 514, 1381, 20, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21817, 539, 7658, 149, 520, "Input"],
Cell[29478, 690, 1902, 40, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31417, 735, 5348, 105, 240, "Input"],
Cell[36768, 842, 4158, 61, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40963, 908, 15726, 342, 772, "Input"],
Cell[CellGroupData[{
Cell[56714, 1254, 589, 9, 30, "Print"],
Cell[57306, 1265, 587, 9, 30, "Print"],
Cell[57896, 1276, 606, 9, 30, "Print"]
}, Open  ]],
Cell[58517, 1288, 615, 16, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59169, 1309, 218, 6, 43, "Input"],
Cell[59390, 1317, 373, 9, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59800, 1331, 4677, 96, 352, "Input"],
Cell[64480, 1429, 2106, 43, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66623, 1477, 4711, 122, 212, "Input"],
Cell[71337, 1601, 1150, 16, 41, "Output"],
Cell[72490, 1619, 9380, 305, 564, "Output"]
}, Open  ]],
Cell[81885, 1927, 96, 1, 43, "Input"],
Cell[81984, 1930, 96, 1, 43, "Input"],
Cell[CellGroupData[{
Cell[82105, 1935, 5859, 143, 688, "Input"],
Cell[87967, 2080, 1679, 23, 41, "Output"]
}, Open  ]],
Cell[89661, 2106, 241, 3, 43, "Input"],
Cell[CellGroupData[{
Cell[89927, 2113, 2887, 81, 268, "Input"],
Cell[92817, 2196, 1428, 34, 45, "Output"]
}, Open  ]]
}
]
*)

