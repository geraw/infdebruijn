\documentclass{article}
%\documentclass[letterpaper, 10 pt, conference]{ieeeconf}  

%\IEEEoverridecommandlockouts        % This command is only needed if you want to use the \thanks command
%\overrideIEEEmargins                        % See the \addtolength command later in the file to balance the column lengths


% Name clashes workaround
%\makeatletter
%\let\IEEEproof\proof
%\let\IEEEendproof\endproo f
%\let\proof\@undefined
%\let\endproof\@undefined
%\makeatother


\usepackage{epsfig} 
\usepackage{amsmath} 
\usepackage{amssymb} 
\usepackage{amsthm}  
\usepackage{hyperref}
\usepackage{tikz}
\usetikzlibrary{automata,arrows,decorations.pathmorphing,decorations.markings,positioning}
\usetikzlibrary{shapes}
%\usepackage{balance}




% Theorem like env.
\newtheorem{theorem}{Theorem}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{claim}[theorem]{Claim}


\theoremstyle{definition}
\newtheorem{definition}{Definition}     
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{observation}[theorem]{Observation}
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{corrolary}[theorem]{Corrolary}


%------------------------------------------- preamble ---------------------------

\newcommand{\R}{{\mathbb{R}}}
\newcommand{\N}{{\mathbb{N}}}
\newcommand{\C}{{\mathbb{C}}}
\newcommand{\Z}{{\mathbb{Z}}}

\newcommand{\REF}[2]{#1~\ref{#2}}

\newcommand{\T}[1]{\langle{#1}\rangle}
\newcommand{\rr}[2]{R^{#2}({#1})}
\newcommand{\rl}[2]{R^{-{#2}}({#1})}


\newcommand{\AorB}[2]{\bigl(#2\text{?}A(#1)\text{:}B(#1)\bigr)}


\pagestyle{plain}


\title{On Combinatorial Games and de Bruijn Sequences}

\author{Yotam Svoray and %Gera Weiss\\
	Department of Computer Science \\
	Ben Gurion University of the Negev\\
	Israel
}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{definition}
	For a parameter $n$, Let $L \subset \N^+$ be the set of non-periodic words over the alphabet $\Sigma=\N$ that are bigger in Arabic (right-to-left) lexicographical order than all of their rotations. Let $L_n$ be the set of all the words in $L$ whose length divides $n$.
\end{definition}


\begin{definition}
	For a word $w=w_1\cdots w_{n-1}w_n$ let  $\rr{w}{}= w_{n}w_1\cdots w_{n-1}$ be the rotation of $w$ to the right. Then, the nested invocation $\rr{w}{m}$ is the $m$ letter rotation to the right and its inverse $\rl{w}{m}$ is the $m$ letter rotation to the left.
\end{definition}

	
\section{Forward and backwards transformations}


\begin{definition}\label{forward}
For a word $w$ whose length is smaller or equal than $n$, let  $f(w)$ be the transformation defined by successive applications of the following steps to $w$:
\begin{enumerate}
	\item[$f_1$:] Increase the first letter of the word by one. 
	\item[$f_2$:] Pad with zeros on the left to get a word of length $n$.
	\item[$f_3$:] Apply the substitution rules $u(vu)^+ \mapsto vu$ and then $w^+ \mapsto w$, with the longest possible $u$ and the shortest possible $w$.
\end{enumerate}
\end{definition}

\begin{definition}\label{backward}
For a a word $w$ whose length is smaller or equal than $n$, let  $b(w)$ be the transformation defined by successive applications of the following steps to $w$:
\begin{enumerate}
	\item[$b_1$:] Expand $w$ to $u w^m$ where $m=\lfloor n/ |w| \rfloor$ and $u$ is the suffix of length $n-m|w|$ of $w$.
	
	\item[$b_2$:] Remove leading zeros.
	\item[$b_3$:] Decrease the first letter by one.
\end{enumerate}
\end{definition}

\begin{observation}
	For any $w\in L_n$, $f(b(w))=b(f(w))=w$.
\end{observation}



\begin{proposition}
	If we start with $w(0)=0$ and generate a sequence of words by $w({i+1})=f(w(i))$, we get an enumeration of all the words in $L$ whose length is smaller or equal to $n$.
\end{proposition}
\begin{proof}
	This is a version of Duval's algorithm with a reversed order of the alphabet and a reversed order of letters in a word. 
\end{proof}

\begin{definition} \label{star-functions}
	Let $f^*(w)$ be the first word in ${f(w),f(f(w)),\dots}$ whose length divides $n$ and, similarly, let $b^*(w)$ be the first word in ${b(w),b(b(w)),\dots}$ whose length divides $n$. 
\end{definition}


\begin{definition}
	Let $w(0),w(1),...$ be the sequence generated by starting with $w(0)=0$ and then continuing ad infinitum by $w{(i+1)}=f^*(w(i))$ and let $w^\infty\in \N^\omega$ be the concatenation of all these words.
\end{definition}



\section{Where can I find $w$ as a sub-word of $w^\infty$?}

In this section we point at the position of an arbitrary word $w$ as a sub-word of  $w^\infty$ relative to the position of the a corresponding word in $L_n$. This is given in Proposition~\ref{simple-pos} and in Proposition~\ref{advanced-pos}. Towards the proofs of these propositions, we first establish some technical results about the functions $b$ and $b^*$ specified, respectively, in Definition~\ref{backward} and in Definition~\ref{star-functions}.


\begin{proposition}
	\label{w-at-the-tail}
	If $w \in L_n$ and $|w| \neq n$ then  $b(w)=uw$ for some non-empty word $u$. 
\end{proposition}
\begin{proof}
	The first transformation $b_1$ extends $w$ to the left producing the word $b_1(w)=uw^m$ where $u$ is a tail of $w$. Since $w \in L_n$ and because it contains a letter $\sigma$ that is not zero, we have, by maximality of $w$ among its rotations in right-to-left lexicographical order,  that its last letter is not zero. The last letter of $u$ is the last letter of $w$ so it is also not zero. This gives us that the next transformation $b_2$, that deletes trailing zeros, leaves at least the last copy of $w$ and the last letter of the before-last (full or partial) copy at the tail of $b_1(w)$. Thus, $b_2(b_1(w))=uw$ where $u$ is a non-empty word whose first letter is not zero. Then, the last transformation $b_3$ only decreases the first letter of $u$ by  one which gives us that $b(w)=b_3(b_2(b_1(w)))=vw$ for some non-empty word $v$.	
\end{proof}
	
\begin{proposition}
	\label{hat-w-at-the-tail}
	For any $w=0^l \sigma \hat{w}\in L_n$ where $\sigma$ is a non-zero letter there is a non-empty word $u$ such that $b(w)=u\hat{w}$.
\end{proposition}
\begin{proof}
	If $|w|\neq n$ the proof follows by Proposition~\ref{w-at-the-tail}. If $|w|=n$ then $b_1(w)=w$, $b_2(b_1(w))=\sigma\hat{w}$, and $b_3(b_2(b_1(w)))=(\sigma-1)\hat{w}$ and the claim follows as well.
\end{proof}
	
	
\begin{proposition}\label{simple-pos}
	Let $w$ be an arbitrary word in $\N^n$ and let and let $\bar{w}=f_3(w)$. Let $l$ be the (possibly zero) number of trailing zeros (from the left) in $w$.  Then, for all $0 \leq i \leq |w|-l-1$, the word $\rr{\bar{w}}{i}$ comes $i+n-|w|$ letters before $w$ as a sub-word of $w^\infty$.
\end{proposition}



\begin{proposition}\label{simple-pos}
	For a given $w \in L_n$, let $l$ be the number of trailing zeros (from the left) in $w$ and let $\bar{w}=b_1(w)$. Then, for all $0 \leq i \leq |w|-l-1$, the word $\rr{\bar{w}}{i}$ comes $i+n-|w|$ letters before $w$ as a sub-word of $w^\infty$.
\end{proposition}
\begin{proof}
	By Proposition~\ref{tail-is-preseved*} the words that come before $w$ ends with the last $|w|-l$ letters of $w$. In particular, the $n$ letter word that starts $i+n-|w|$ before $w$ is $\rr{\bar{w}}{i}$.
\end{proof}

\begin{proposition}\label{advanced-pos}
	For a given $w \in L_n$, let $l$ be the number of trailing zeros (from the left) in $w$ and let $\bar{w}=b_1(w)$. Then, for all $|w|-l \leq i \leq n-1$ the word $\rr{\bar{w}}{i}$ comes $i-(n-|f_3(u)| \pmod n)$ letters before the first $u \in \T{0^{m-1} (\bar{w}_{m} + 1) \bar{w}_{m+1}\cdots \bar{w}_n}_{m=i+1}^{n}$ that is in $L_n$. 
\end{proposition}


\begin{proposition}
	The word $w^\infty$ contains all the words in $\N^n$ as subwords.
\end{proposition}
\begin{proof}
	Any word of length $n$ is a rotation of the expansion of a word in $L_n$.
\end{proof}


\begin{proposition}
	For any $k$ the prefix $w^\infty_1 \cdots w^\infty_{k^n}$ is an $n$-order de Bruijn sequences. Moreover, it is the reversed of the n-order prefer-max sequence on the alphabet $\T{0,\dots,k-1}$ (in this order). 
\end{proposition}
\begin{proof}
	Counting argument + arguing that if $|w| =n-1$ and $\sigma_1 < \sigma_2$ then $w\sigma_1$ comes before $w\sigma_2$ as subwords of $w^\infty$.
\end{proof}


\begin{proposition}
	For $w \in \N^n$, let $i$ be the minimal index such that $\rl{w}{i} \in L$ and let $\bar{w}=\rl{w}{i}$. Let $\bar{w}^+=\bar{w}_{1..i}(\bar{w}_{i+1}+1)\bar{w}_{(i+2)..n}$, i.e., the word obtained by increasing the $(i+1)th$ letter of $\bar{w}$ by one.  Then, the function
	$$next(w)=
	\begin{cases}
	f^*(f_3(w))_1 & \text{if } w \in L; \\
	w_1+1         & \text{if }\bar{w}_{1..i}= 0^i \wedge \bar{w}^+ \in L\wedge \max{(\bar{w}^+_{1..(n-1)})} \leq \max(w); \\
	0             & \text{if }\bar{w}_{1..i}= 0^i \wedge (\bar{w}^+ \notin L \vee \max{(\bar{w}^+_{1..(n-1)})} > \max(w)); \\
	w_1           & \text{otherwise.}
	\end{cases}$$
	represents the mapping of a word $w$ to the letter that follows the (one and only) occurrence of $w$ as a subword of $w^\infty$.
\end{proposition}

\begin{definition}
	Let $w(0)=0, w(1)=f^*(w(0)),\dots,w(i)=f^*(w{(i-1)}),\dots$ be our enumeration of all the words in $L_n$. Let $w^{(i)}=w(0)\cdots w(i)$ be the concatenation of the first $i$ words in this enumeration and let $u(j)=w^{(i)}_{j-n+1}\cdots w^{(i)}_j$ be the ``window'' of length $n$ before the $j$th letter in $w^{(i)}$.
\end{definition}

\begin{proposition}
	Let $w=w(i)$ for some $i$ and let $l$ be the number of leading zeros in $w$.
	Then, inserting the cycle $\T{R^{-l-n-1}(w),\dots,R^{-l}(w)}$ to $\T{u(j)}_{j=0}^{i-1}$
	 after the word obtained from $R^{-l}(w)$ by decreasing its first letter by one
	 yields the sequence $\T{u(j)}_{j=0}^{i}$.
\end{proposition}		
	
		
\end{document}
	
	
